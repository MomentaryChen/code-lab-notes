<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A* ç®—æ³•è¯¦è§£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 40px;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        h2 {
            color: #764ba2;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            font-size: 1.8em;
        }

        h3 {
            color: #555;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .formula {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
            border: 2px solid #667eea;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .formula code {
            font-size: 1.2em;
            color: #764ba2;
        }

        .step {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #764ba2;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #e83e8c;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
        }

        pre code {
            background: transparent;
            color: #f8f8f2;
            padding: 0;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(10, 70px);
            gap: 3px;
            margin: 20px auto;
            justify-content: center;
            padding: 25px;
            background: #e8e8e8;
            border-radius: 10px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }

        .cell {
            width: 70px;
            height: 70px;
            border: 2px solid #666;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.85em;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            border-radius: 4px;
            padding: 2px;
        }

        .cell .icon {
            font-size: 1.3em;
            line-height: 1;
            margin-bottom: 2px;
        }

        .cell .coords {
            font-size: 0.55em;
            opacity: 0.8;
            margin-top: 1px;
            font-weight: normal;
        }

        .cell .values {
            font-size: 0.5em;
            margin-top: 2px;
            line-height: 1.2;
            text-align: center;
        }

        .cell .values .f-value {
            font-weight: bold;
            color: inherit;
        }

        .cell .values .g-value {
            color: #1976d2;
        }

        .cell .values .h-value {
            color: #d32f2f;
        }

        .cell.start {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border-color: #2e7d32;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        .cell.start .icon::before {
            content: "ğŸš©";
        }

        .cell.end {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
            border-color: #c62828;
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
        }

        .cell.end .icon::before {
            content: "ğŸ¯";
        }

        .cell.wall {
            background: linear-gradient(135deg, #424242 0%, #212121 100%);
            color: white;
            border-color: #000;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
        }

        .cell.wall .icon::before {
            content: "â¬›";
        }

        .cell.path {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            border-color: #1565C0;
            box-shadow: 0 0 8px rgba(33, 150, 243, 0.6);
        }

        .cell.path .icon::before {
            content: "â­";
        }

        .cell.open {
            background: linear-gradient(135deg, #C8E6C9 0%, #A5D6A7 100%);
            border-color: #81C784;
            color: #2e7d32;
        }

        .cell.open .icon::before {
            content: "â—‹";
            color: #2e7d32;
        }

        .cell.closed {
            background: linear-gradient(135deg, #FFCDD2 0%, #EF9A9A 100%);
            border-color: #E57373;
            color: #c62828;
        }

        .cell.closed .icon::before {
            content: "âœ•";
            color: #c62828;
        }

        .cell.current {
            background: linear-gradient(135deg, #FFD700 0%, #FFC107 100%);
            border-color: #FFA000;
            color: #F57C00;
            animation: pulse 1s infinite;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            z-index: 10;
        }

        .cell.current .icon::before {
            content: "ğŸ“";
        }

        .cell.empty {
            background: #FAFAFA;
            border-color: #BDBDBD;
            color: #757575;
        }

        .cell.empty .coords {
            opacity: 1;
            font-weight: 500;
            color: #757575;
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            }
            50% { 
                transform: scale(1.15);
                box-shadow: 0 0 25px rgba(255, 215, 0, 1);
            }
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 25px 0;
            justify-content: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-weight: 500;
        }

        .legend-color {
            width: 40px;
            height: 40px;
            border: 2px solid #666;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .tip {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .warning {
            background: #fff3cd;
            border-left: 4px solid #856404;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .button-group {
            text-align: center;
            margin: 20px 0;
        }

        .scenario-tabs {
            display: flex;
            justify-content: center;
            margin: 10px auto 20px;
            gap: 8px;
            flex-wrap: wrap;
        }

        .scenario-tab {
            padding: 8px 14px;
            border-radius: 999px;
            border: 1px solid #667eea;
            color: #667eea;
            background: #fff;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }

        .scenario-tab:hover {
            background: #eef2ff;
        }

        .scenario-tab.active {
            background: #667eea;
            color: #fff;
            box-shadow: 0 2px 6px rgba(102, 126, 234, 0.6);
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            margin: 5px;
            transition: background 0.3s;
        }

        button:hover {
            background: #764ba2;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
<div style="position: sticky; top: 0; z-index: 1000; padding: 12px 16px; background: linear-gradient(to bottom, rgba(15,23,42,0.96), rgba(15,23,42,0.75)); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-bottom: 1px solid rgba(148,163,184,0.35); display: flex; justify-content: space-between; align-items: center; font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; color: #e5e7eb;">
    <a href="index.html"
       style="display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 999px; border: 1px solid rgba(148,163,184,0.6); background: radial-gradient(circle at top left, rgba(56,189,248,0.12), rgba(15,23,42,0.95)); color: #e5e7eb; font-size: 13px; text-decoration: none; box-shadow: 0 8px 18px rgba(15,23,42,0.8);">
        <span style="font-size: 14px;">â†</span>
        <span>å›åˆ°é¦–é </span>
    </a>
    <span style="font-size: 12px; color: #9ca3af;">A* Algorithm Explanation</span>
</div>
    <div class="container">
        <h1>ğŸš€ A* ç®—æ³•å®Œæ•´è¯¦è§£</h1>
        <p class="subtitle">ä»åŸç†åˆ°å®ç°ï¼Œæ·±å…¥ç†è§£æœ€çŸ­è·¯å¾„æœç´¢ç®—æ³•</p>

        <!-- 1. ç®—æ³•æ¦‚è¿° -->
        <div class="section">
            <h2>1. ä»€ä¹ˆæ˜¯ A* ç®—æ³•ï¼Ÿ</h2>
            <p>A*ï¼ˆA-Starï¼‰ç®—æ³•æ˜¯ä¸€ç§åœ¨å›¾å½¢ä¸­å¯»æ‰¾ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„çš„å¯å‘å¼æœç´¢ç®—æ³•ã€‚å®ƒç»“åˆäº†<strong>Dijkstraç®—æ³•</strong>ï¼ˆä¿è¯æ‰¾åˆ°æœ€çŸ­è·¯å¾„ï¼‰å’Œ<strong>è´ªå¿ƒæœ€ä½³ä¼˜å…ˆæœç´¢</strong>ï¼ˆä½¿ç”¨å¯å‘å¼å‡½æ•°åŠ é€Ÿæœç´¢ï¼‰çš„ä¼˜ç‚¹ã€‚</p>
            
            <div class="tip">
                <strong>ğŸ’¡ æ ¸å¿ƒæ€æƒ³ï¼š</strong>A* ç®—æ³•é€šè¿‡è¯„ä¼°å‡½æ•° f(n) = g(n) + h(n) æ¥å†³å®šä¸‹ä¸€æ­¥æ¢ç´¢å“ªä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­ g(n) æ˜¯ä»èµ·ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„å®é™…ä»£ä»·ï¼Œh(n) æ˜¯ä»å½“å‰èŠ‚ç‚¹åˆ°ç»ˆç‚¹çš„ä¼°è®¡ä»£ä»·ï¼ˆå¯å‘å¼å‡½æ•°ï¼‰ã€‚
            </div>
        </div>

        <!-- 2. æ ¸å¿ƒå…¬å¼ -->
        <div class="section">
            <h2>2. æ ¸å¿ƒå…¬å¼</h2>
            <div class="formula">
                f(n) = g(n) + h(n)
            </div>
            
            <h3>2.1 å„å‚æ•°å«ä¹‰</h3>
            <ul style="margin-left: 20px; line-height: 2;">
                <li><span class="highlight">f(n)</span>ï¼šèŠ‚ç‚¹ n çš„æ€»è¯„ä¼°å€¼ï¼ˆè¶Šå°è¶Šå¥½ï¼‰</li>
                <li><span class="highlight">g(n)</span>ï¼šä»èµ·ç‚¹åˆ°èŠ‚ç‚¹ n çš„<strong>å®é™…ä»£ä»·</strong>ï¼ˆå·²èµ°è¿‡çš„è·¯å¾„é•¿åº¦ï¼‰</li>
                <li><span class="highlight">h(n)</span>ï¼šä»èŠ‚ç‚¹ n åˆ°ç»ˆç‚¹çš„<strong>ä¼°è®¡ä»£ä»·</strong>ï¼ˆå¯å‘å¼å‡½æ•°ï¼Œå¿…é¡»å¯æ¥å—ï¼‰</li>
            </ul>

            <div class="warning">
                <strong>âš ï¸ é‡è¦çº¦æŸï¼š</strong>å¯å‘å¼å‡½æ•° h(n) å¿…é¡»æ˜¯<strong>å¯æ¥å—çš„ï¼ˆadmissibleï¼‰</strong>ï¼Œå³å®ƒæ°¸è¿œä¸èƒ½é«˜ä¼°åˆ°è¾¾ç»ˆç‚¹çš„å®é™…ä»£ä»·ã€‚è¿™æ ·æ‰èƒ½ä¿è¯ A* ç®—æ³•æ‰¾åˆ°æœ€ä¼˜è§£ã€‚
            </div>
        </div>

        <!-- 3. ç®—æ³•æ­¥éª¤ -->
        <div class="section">
            <h2>3. ç®—æ³•è¯¦ç»†æ­¥éª¤</h2>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>åˆå§‹åŒ–ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>åˆ›å»ºä¸¤ä¸ªé›†åˆï¼š<code>openSet</code>ï¼ˆå¾…æ¢ç´¢èŠ‚ç‚¹ï¼‰å’Œ <code>closedSet</code>ï¼ˆå·²æ¢ç´¢èŠ‚ç‚¹ï¼‰</li>
                    <li>å°†èµ·ç‚¹åŠ å…¥ <code>openSet</code></li>
                    <li>è®¾ç½®èµ·ç‚¹çš„ g(èµ·ç‚¹) = 0ï¼Œf(èµ·ç‚¹) = h(èµ·ç‚¹)</li>
                    <li>è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼ˆç”¨äºå›æº¯è·¯å¾„ï¼‰</li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">2</span>
                <strong>å¾ªç¯æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼Œç›´åˆ°æ‰¾åˆ°ç»ˆç‚¹æˆ– openSet ä¸ºç©ºï¼š</strong>
            </div>

            <div class="step">
                <span class="step-number">2.1</span>
                <strong>é€‰æ‹©å½“å‰èŠ‚ç‚¹ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>ä» <code>openSet</code> ä¸­é€‰æ‹© f(n) å€¼æœ€å°çš„èŠ‚ç‚¹ä½œä¸ºå½“å‰èŠ‚ç‚¹</li>
                    <li>å¦‚æœ f(n) å€¼ç›¸åŒï¼Œé€šå¸¸é€‰æ‹© h(n) å€¼è¾ƒå°çš„ï¼ˆæ›´æ¥è¿‘ç»ˆç‚¹ï¼‰</li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">2.2</span>
                <strong>æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ç»ˆç‚¹ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯ç»ˆç‚¹ï¼Œ<strong>å›æº¯è·¯å¾„</strong>å¹¶è¿”å›ç»“æœ</li>
                    <li>å›æº¯æ–¹æ³•ï¼šä»ç»ˆç‚¹å¼€å§‹ï¼Œæ²¿ç€çˆ¶èŠ‚ç‚¹æŒ‡é’ˆä¸€ç›´è¿½æº¯åˆ°èµ·ç‚¹</li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">2.3</span>
                <strong>å¤„ç†å½“å‰èŠ‚ç‚¹ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å°†å½“å‰èŠ‚ç‚¹ä» <code>openSet</code> ç§»é™¤</li>
                    <li>å°†å½“å‰èŠ‚ç‚¹åŠ å…¥ <code>closedSet</code></li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">2.4</span>
                <strong>æ¢ç´¢é‚»å±…èŠ‚ç‚¹ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>éå†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹</li>
                    <li>è·³è¿‡éšœç¢ç‰©å’Œå·²åœ¨ <code>closedSet</code> ä¸­çš„èŠ‚ç‚¹</li>
                    <li>å¯¹äºæ¯ä¸ªé‚»å±…èŠ‚ç‚¹ï¼š
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>è®¡ç®—ä»èµ·ç‚¹åˆ°è¯¥é‚»å±…çš„æ–°ä»£ä»·ï¼š<code>tentative_g = g(å½“å‰èŠ‚ç‚¹) + ç§»åŠ¨ä»£ä»·</code></li>
                            <li>å¦‚æœé‚»å±…ä¸åœ¨ <code>openSet</code> ä¸­ï¼Œå°†å…¶åŠ å…¥</li>
                            <li>å¦‚æœ <code>tentative_g < g(é‚»å±…)</code>ï¼ˆæ‰¾åˆ°æ›´å¥½çš„è·¯å¾„ï¼‰ï¼Œæ›´æ–°ï¼š
                                <ul style="margin-left: 20px; margin-top: 5px;">
                                    <li>g(é‚»å±…) = tentative_g</li>
                                    <li>f(é‚»å±…) = g(é‚»å±…) + h(é‚»å±…)</li>
                                    <li>çˆ¶èŠ‚ç‚¹(é‚»å±…) = å½“å‰èŠ‚ç‚¹</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">3</span>
                <strong>ç»“æŸï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å¦‚æœ <code>openSet</code> ä¸ºç©ºä¸”æœªæ‰¾åˆ°ç»ˆç‚¹ï¼Œè¯´æ˜<strong>ä¸å­˜åœ¨è·¯å¾„</strong></li>
                    <li>å¦‚æœæ‰¾åˆ°ç»ˆç‚¹ï¼Œè¿”å›é‡æ„çš„è·¯å¾„</li>
                </ul>
            </div>
        </div>

        <!-- 3.5 èŠ‚ç‚¹è¯„ä¼°ä¸è®¡ç®—è¯¦è§£ -->
        <div class="section">
            <h2>3.5 èŠ‚ç‚¹è¯„ä¼°ä¸è®¡ç®—è¯¦è§£</h2>
            <p>è¿™æ˜¯ A* ç®—æ³•çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œç†è§£èŠ‚ç‚¹å¦‚ä½•è¢«è¯„ä¼°å’Œè®¡ç®—å¯¹äºæŒæ¡ç®—æ³•è‡³å…³é‡è¦ã€‚</p>

            <h3>ğŸ“Š èŠ‚ç‚¹è¯„ä¼°çš„ä¸‰ä¸ªå…³é”®å€¼</h3>
            
            <div class="step">
                <h4 style="color: #667eea; margin-bottom: 10px;">1. g(n) - å®é™…ä»£ä»·ï¼ˆä»èµ·ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·ç¦»ï¼‰</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>å«ä¹‰ï¼š</strong>ä»èµ·ç‚¹åˆ°èŠ‚ç‚¹ n çš„<strong>å®é™…å·²èµ°è·¯å¾„</strong>çš„æ€»ä»£ä»·</li>
                    <li><strong>è®¡ç®—æ–¹å¼ï¼š</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>èµ·ç‚¹ï¼šg(èµ·ç‚¹) = 0</li>
                            <li>å…¶ä»–èŠ‚ç‚¹ï¼šg(èŠ‚ç‚¹) = g(çˆ¶èŠ‚ç‚¹) + ç§»åŠ¨ä»£ä»·</li>
                            <li>åœ¨ç½‘æ ¼åœ°å›¾ä¸­ï¼Œç›¸é‚»èŠ‚ç‚¹ç§»åŠ¨ä»£ä»·é€šå¸¸ä¸º 1</li>
                        </ul>
                    </li>
                    <li><strong>ç‰¹ç‚¹ï¼š</strong>è¿™ä¸ªå€¼æ˜¯<strong>ç¡®å®šçš„ã€å‡†ç¡®çš„</strong>ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»å®é™…èµ°è¿‡äº†è¿™æ¡è·¯å¾„</li>
                </ul>
                
                <div style="background: #e8f5e9; padding: 15px; margin-top: 15px; border-radius: 8px; border-left: 4px solid #4CAF50;">
                    <strong>ğŸ’¡ ç¤ºä¾‹ï¼š</strong>å¦‚æœèµ·ç‚¹æ˜¯ (0,0)ï¼Œå½“å‰èŠ‚ç‚¹æ˜¯ (2,1)ï¼Œè·¯å¾„æ˜¯ (0,0) â†’ (1,0) â†’ (2,0) â†’ (2,1)
                    <br>é‚£ä¹ˆ g(2,1) = 0 + 1 + 1 + 1 = <strong>3</strong>
                </div>
            </div>

            <div class="step">
                <h4 style="color: #667eea; margin-bottom: 10px;">2. h(n) - å¯å‘å¼ä¼°è®¡ï¼ˆä»å½“å‰èŠ‚ç‚¹åˆ°ç»ˆç‚¹çš„ä¼°è®¡è·ç¦»ï¼‰</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>å«ä¹‰ï¼š</strong>ä»èŠ‚ç‚¹ n åˆ°ç»ˆç‚¹çš„<strong>ä¼°è®¡ä»£ä»·</strong>ï¼ˆæˆ‘ä»¬è¿˜æ²¡æœ‰å®é™…èµ°è¿‡ï¼‰</li>
                    <li><strong>è®¡ç®—æ–¹å¼ï¼š</strong>ä½¿ç”¨å¯å‘å¼å‡½æ•°ï¼Œå¸¸ç”¨æ›¼å“ˆé¡¿è·ç¦»ï¼š
                        <div class="formula" style="margin: 10px 0;">
                            h(n) = |xâ‚ - xâ‚‚| + |yâ‚ - yâ‚‚|
                        </div>
                    </li>
                    <li><strong>ç‰¹ç‚¹ï¼š</strong>è¿™ä¸ªå€¼æ˜¯<strong>ä¼°è®¡çš„ã€è¿‘ä¼¼çš„</strong>ï¼Œå¸®åŠ©æˆ‘ä»¬"çŒœæµ‹"è·ç¦»ç»ˆç‚¹è¿˜æœ‰å¤šè¿œ</li>
                    <li><strong>çº¦æŸï¼š</strong>å¿…é¡»<strong>å¯æ¥å—ï¼ˆadmissibleï¼‰</strong>ï¼Œå³ä¸èƒ½é«˜ä¼°å®é™…è·ç¦»</li>
                </ul>
                
                <div style="background: #e8f5e9; padding: 15px; margin-top: 15px; border-radius: 8px; border-left: 4px solid #4CAF50;">
                    <strong>ğŸ’¡ ç¤ºä¾‹ï¼š</strong>å½“å‰èŠ‚ç‚¹æ˜¯ (2,1)ï¼Œç»ˆç‚¹æ˜¯ (9,9)
                    <br>h(2,1) = |2 - 9| + |1 - 9| = 7 + 8 = <strong>15</strong>
                    <br>è¿™è¡¨ç¤ºæˆ‘ä»¬ä¼°è®¡ä» (2,1) åˆ° (9,9) è‡³å°‘éœ€è¦ 15 æ­¥
                </div>
            </div>

            <div class="step">
                <h4 style="color: #667eea; margin-bottom: 10px;">3. f(n) - æ€»è¯„ä¼°å€¼ï¼ˆèŠ‚ç‚¹ä¼˜å…ˆçº§ï¼‰</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>å«ä¹‰ï¼š</strong>èŠ‚ç‚¹ n çš„<strong>æ€»è¯„ä¼°å€¼</strong>ï¼Œç”¨äºå†³å®šæ¢ç´¢ä¼˜å…ˆçº§</li>
                    <li><strong>è®¡ç®—æ–¹å¼ï¼š</strong>
                        <div class="formula" style="margin: 10px 0;">
                            f(n) = g(n) + h(n)
                        </div>
                    </li>
                    <li><strong>ä½œç”¨ï¼š</strong>f(n) å€¼<strong>è¶Šå°</strong>ï¼ŒèŠ‚ç‚¹ä¼˜å…ˆçº§<strong>è¶Šé«˜</strong>ï¼Œè¶Šå…ˆè¢«æ¢ç´¢</li>
                    <li><strong>å«ä¹‰ï¼š</strong>f(n) è¡¨ç¤º"ä»èµ·ç‚¹ç»è¿‡èŠ‚ç‚¹ n åˆ°è¾¾ç»ˆç‚¹çš„ä¼°è®¡æ€»ä»£ä»·"</li>
                </ul>
                
                <div style="background: #e8f5e9; padding: 15px; margin-top: 15px; border-radius: 8px; border-left: 4px solid #4CAF50;">
                    <strong>ğŸ’¡ ç¤ºä¾‹ï¼š</strong>èŠ‚ç‚¹ (2,1) çš„è¯„ä¼°
                    <br>g(2,1) = 3ï¼ˆå·²èµ°3æ­¥ï¼‰
                    <br>h(2,1) = 15ï¼ˆä¼°è®¡è¿˜éœ€15æ­¥ï¼‰
                    <br>f(2,1) = 3 + 15 = <strong>18</strong>
                    <br>è¿™æ„å‘³ç€æˆ‘ä»¬ä¼°è®¡ä»èµ·ç‚¹ç»è¿‡ (2,1) åˆ°è¾¾ç»ˆç‚¹æ€»å…±éœ€è¦ 18 æ­¥
                </div>
            </div>

            <h3>ğŸ”„ èŠ‚ç‚¹è¯„ä¼°çš„å®Œæ•´æµç¨‹</h3>

            <div class="step">
                <span class="step-number">æ­¥éª¤1</span>
                <strong>åˆå§‹åŒ–èµ·ç‚¹ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>g(èµ·ç‚¹) = 0ï¼ˆèµ·ç‚¹åˆ°è‡ªå·±çš„è·ç¦»ä¸º0ï¼‰</li>
                    <li>h(èµ·ç‚¹) = æ›¼å“ˆé¡¿è·ç¦»(èµ·ç‚¹, ç»ˆç‚¹)</li>
                    <li>f(èµ·ç‚¹) = g(èµ·ç‚¹) + h(èµ·ç‚¹) = 0 + h(èµ·ç‚¹)</li>
                    <li>å°†èµ·ç‚¹åŠ å…¥ <code>openSet</code></li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">æ­¥éª¤2</span>
                <strong>é€‰æ‹©ä¸‹ä¸€ä¸ªè¦æ¢ç´¢çš„èŠ‚ç‚¹ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>éå† <code>openSet</code> ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹</li>
                    <li>æ‰¾åˆ° <strong>f(n) å€¼æœ€å°</strong>çš„èŠ‚ç‚¹</li>
                    <li>å¦‚æœå¤šä¸ªèŠ‚ç‚¹ f(n) ç›¸åŒï¼Œé€‰æ‹© h(n) è¾ƒå°çš„ï¼ˆæ›´æ¥è¿‘ç»ˆç‚¹ï¼‰</li>
                    <li>è¿™ä¸ªèŠ‚ç‚¹æˆä¸º<strong>å½“å‰èŠ‚ç‚¹</strong></li>
                </ul>
                
                <div style="background: #fff3cd; padding: 15px; margin-top: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
                    <strong>ğŸ“ ç¤ºä¾‹åœºæ™¯ï¼š</strong>
                    <br>openSet ä¸­æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼š
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>èŠ‚ç‚¹A: f=12, g=5, h=7</li>
                        <li>èŠ‚ç‚¹B: f=10, g=4, h=6 â† <strong>é€‰æ‹©è¿™ä¸ªï¼ˆfå€¼æœ€å°ï¼‰</strong></li>
                        <li>èŠ‚ç‚¹C: f=12, g=6, h=6</li>
                    </ul>
                </div>
            </div>

            <div class="step">
                <span class="step-number">æ­¥éª¤3</span>
                <strong>è¯„ä¼°å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å¯¹äºæ¯ä¸ªé‚»å±…èŠ‚ç‚¹ï¼Œæ‰§è¡Œä»¥ä¸‹è®¡ç®—ï¼š</li>
                </ul>
                
                <div style="background: #f5f5f5; padding: 20px; margin: 15px 0; border-radius: 8px; border: 2px solid #667eea;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">å¯¹äºé‚»å±…èŠ‚ç‚¹ neighborï¼š</h4>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>3.1 è®¡ç®— tentative_gï¼ˆä¸´æ—¶gå€¼ï¼‰ï¼š</strong>
                        <div class="formula" style="margin: 10px 0; font-size: 1.1em;">
                            tentative_g = g(å½“å‰èŠ‚ç‚¹) + ç§»åŠ¨ä»£ä»·
                        </div>
                        <p style="margin-left: 20px;">åœ¨ç½‘æ ¼åœ°å›¾ä¸­ï¼Œç§»åŠ¨ä»£ä»·é€šå¸¸ä¸º 1</p>
                    </div>

                    <div style="margin-bottom: 15px;">
                        <strong>3.2 æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°æ›´å¥½çš„è·¯å¾„ï¼š</strong>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>å¦‚æœ neighbor ä¸åœ¨ <code>openSet</code> ä¸­ï¼š
                                <ul style="margin-left: 20px;">
                                    <li>å°† neighbor åŠ å…¥ <code>openSet</code></li>
                                    <li>è®¾ç½® g(neighbor) = tentative_g</li>
                                    <li>è®¡ç®— h(neighbor) = æ›¼å“ˆé¡¿è·ç¦»(neighbor, ç»ˆç‚¹)</li>
                                    <li>è®¡ç®— f(neighbor) = g(neighbor) + h(neighbor)</li>
                                    <li>è®¾ç½® çˆ¶èŠ‚ç‚¹(neighbor) = å½“å‰èŠ‚ç‚¹</li>
                                </ul>
                            </li>
                            <li>å¦‚æœ neighbor å·²åœ¨ <code>openSet</code> ä¸­ï¼š
                                <ul style="margin-left: 20px;">
                                    <li>æ¯”è¾ƒ tentative_g å’Œ g(neighbor)</li>
                                    <li>å¦‚æœ tentative_g < g(neighbor)ï¼ˆæ‰¾åˆ°æ›´å¥½çš„è·¯å¾„ï¼‰ï¼š
                                        <ul style="margin-left: 20px;">
                                            <li>æ›´æ–° g(neighbor) = tentative_g</li>
                                            <li>é‡æ–°è®¡ç®— f(neighbor) = g(neighbor) + h(neighbor)</li>
                                            <li>æ›´æ–° çˆ¶èŠ‚ç‚¹(neighbor) = å½“å‰èŠ‚ç‚¹</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3>ğŸ“ˆ å®é™…è®¡ç®—ç¤ºä¾‹</h3>
            
            <div style="background: #e3f2fd; padding: 20px; margin: 20px 0; border-radius: 8px; border: 2px solid #2196F3;">
                <h4 style="color: #1976d2; margin-bottom: 15px;">åœºæ™¯ï¼š5x5 ç½‘æ ¼åœ°å›¾</h4>
                <ul style="line-height: 2;">
                    <li><strong>èµ·ç‚¹ï¼š</strong>(0, 0)</li>
                    <li><strong>ç»ˆç‚¹ï¼š</strong>(4, 4)</li>
                    <li><strong>å½“å‰èŠ‚ç‚¹ï¼š</strong>(2, 1)ï¼ˆå‡è®¾å·²ä»èµ·ç‚¹èµ°åˆ°è¿™é‡Œï¼‰</li>
                </ul>

                <div style="margin-top: 20px;">
                    <strong>å½“å‰èŠ‚ç‚¹ (2, 1) çš„è®¡ç®—ï¼š</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>g(2,1) = 3ï¼ˆå‡è®¾è·¯å¾„æ˜¯ (0,0)â†’(1,0)â†’(2,0)â†’(2,1)ï¼‰</li>
                        <li>h(2,1) = |2-4| + |1-4| = 2 + 3 = 5</li>
                        <li>f(2,1) = 3 + 5 = 8</li>
                    </ul>
                </div>

                <div style="margin-top: 20px;">
                    <strong>è¯„ä¼°é‚»å±…èŠ‚ç‚¹ (2, 2)ï¼š</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>tentative_g = g(2,1) + 1 = 3 + 1 = 4</li>
                        <li>h(2,2) = |2-4| + |2-4| = 2 + 2 = 4</li>
                        <li>f(2,2) = 4 + 4 = 8</li>
                        <li>å¦‚æœ (2,2) ä¸åœ¨ openSet ä¸­ï¼Œå°†å…¶åŠ å…¥å¹¶è®¾ç½®çˆ¶èŠ‚ç‚¹ä¸º (2,1)</li>
                    </ul>
                </div>

                <div style="margin-top: 20px;">
                    <strong>è¯„ä¼°é‚»å±…èŠ‚ç‚¹ (3, 1)ï¼š</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>tentative_g = g(2,1) + 1 = 3 + 1 = 4</li>
                        <li>h(3,1) = |3-4| + |1-4| = 1 + 3 = 4</li>
                        <li>f(3,1) = 4 + 4 = 8</li>
                        <li>å¦‚æœ (3,1) å·²åœ¨ openSet ä¸­ï¼Œä¸”ä¹‹å‰çš„ g(3,1) = 5ï¼š
                            <ul style="margin-left: 20px;">
                                <li>å› ä¸º tentative_g(4) < g(3,1)(5)ï¼Œæ‰¾åˆ°æ›´å¥½çš„è·¯å¾„</li>
                                <li>æ›´æ–° g(3,1) = 4</li>
                                <li>æ›´æ–° f(3,1) = 4 + 4 = 8</li>
                                <li>æ›´æ–°çˆ¶èŠ‚ç‚¹(3,1) = (2,1)</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

            <h3>ğŸ¯ å…³é”®ç†è§£ç‚¹</h3>
            
            <div class="tip">
                <strong>1. g(n) æ˜¯ç´¯ç§¯çš„å®é™…ä»£ä»·ï¼š</strong>
                <p style="margin-left: 20px; margin-top: 10px;">g(n) è®°å½•çš„æ˜¯ä»èµ·ç‚¹åˆ°èŠ‚ç‚¹ n çš„<strong>å®é™…èµ°è¿‡çš„è·¯å¾„</strong>ã€‚æ¯æ¬¡ç§»åŠ¨ï¼Œg å€¼éƒ½ä¼šå¢åŠ ç§»åŠ¨ä»£ä»·ã€‚</p>
            </div>

            <div class="tip">
                <strong>2. h(n) æ˜¯å¯å‘å¼ä¼°è®¡ï¼š</strong>
                <p style="margin-left: 20px; margin-top: 10px;">h(n) å¸®åŠ©æˆ‘ä»¬"çŒœæµ‹"è·ç¦»ç»ˆç‚¹è¿˜æœ‰å¤šè¿œã€‚å®ƒä¸èƒ½é«˜ä¼°å®é™…è·ç¦»ï¼Œä½†å¯ä»¥ä½ä¼°ã€‚æ›¼å“ˆé¡¿è·ç¦»åœ¨ç½‘æ ¼åœ°å›¾ä¸­æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¯æ¥å—å¯å‘å¼å‡½æ•°ã€‚</p>
            </div>

            <div class="tip">
                <strong>3. f(n) å†³å®šæ¢ç´¢é¡ºåºï¼š</strong>
                <p style="margin-left: 20px; margin-top: 10px;">f(n) = g(n) + h(n) è¡¨ç¤º"ä»èµ·ç‚¹ç»è¿‡èŠ‚ç‚¹ n åˆ°è¾¾ç»ˆç‚¹çš„ä¼°è®¡æ€»ä»£ä»·"ã€‚ç®—æ³•æ€»æ˜¯ä¼˜å…ˆæ¢ç´¢ f å€¼æœ€å°çš„èŠ‚ç‚¹ï¼Œè¿™æ ·å¯ä»¥æœ€å¿«æ‰¾åˆ°æœ€ä¼˜è·¯å¾„ã€‚</p>
            </div>

            <div class="warning">
                <strong>4. è·¯å¾„æ›´æ–°æœºåˆ¶ï¼š</strong>
                <p style="margin-left: 20px; margin-top: 10px;">å½“å‘ç°ä»å½“å‰èŠ‚ç‚¹åˆ°æŸä¸ªé‚»å±…çš„è·¯å¾„æ¯”ä¹‹å‰è®°å½•çš„è·¯å¾„æ›´çŸ­æ—¶ï¼ˆtentative_g < g(neighbor)ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°è¯¥é‚»å±…çš„ g å€¼ã€f å€¼å’Œçˆ¶èŠ‚ç‚¹ã€‚è¿™ç¡®ä¿äº†ç®—æ³•èƒ½æ‰¾åˆ°çœŸæ­£çš„æœ€çŸ­è·¯å¾„ã€‚</p>
            </div>

            <div style="background: #f3e5f5; padding: 20px; margin-top: 20px; border-radius: 8px; border-left: 4px solid #9c27b0;">
                <h4 style="color: #7b1fa2; margin-bottom: 10px;">ğŸ’­ ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>g(n)ï¼š</strong>ä¿è¯æˆ‘ä»¬æ‰¾åˆ°çš„æ˜¯å®é™…æœ€çŸ­è·¯å¾„ï¼ˆæ¥è‡ª Dijkstra ç®—æ³•çš„æ€æƒ³ï¼‰</li>
                    <li><strong>h(n)ï¼š</strong>å¼•å¯¼æœç´¢æ–¹å‘ï¼Œé¿å…ç›²ç›®æ¢ç´¢ï¼ˆæ¥è‡ªè´ªå¿ƒç®—æ³•çš„æ€æƒ³ï¼‰</li>
                    <li><strong>f(n)ï¼š</strong>å¹³è¡¡ä¸¤è€…ï¼Œæ—¢ä¿è¯æœ€ä¼˜æ€§åˆæé«˜æ•ˆç‡</li>
                </ul>
            </div>
        </div>

        <!-- 4. å¯è§†åŒ–æ¼”ç¤º -->
        <div class="section">
            <h2>4. å¯è§†åŒ–æ¼”ç¤º</h2>
            <p>ä¸‹é¢æ˜¯ä¸€ä¸ª 10x10 çš„ç½‘æ ¼åœ°å›¾ï¼Œç‚¹å‡»æŒ‰é’®æŸ¥çœ‹ A* ç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼š</p>
            
            <div class="tip" style="margin-bottom: 20px;">
                <strong>ğŸ“– å¦‚ä½•é˜…è¯»ç½‘æ ¼ï¼š</strong>
                <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                    <li>æ¯ä¸ªå•å…ƒæ ¼æ˜¾ç¤º<strong>å›¾æ ‡</strong>ã€<strong>åæ ‡ (x, y)</strong> å’Œï¼ˆåœ¨éœ€è¦æ—¶ï¼‰<strong>f/g/h å€¼</strong></li>
                    <li>åæ ‡æ ¼å¼ï¼š<code>(x, y)</code>ï¼Œx æ˜¯åˆ—å·ï¼ˆä»å·¦åˆ°å³ï¼‰ï¼Œy æ˜¯è¡Œå·ï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰</li>
                    <li>ä¸åŒé¢œè‰²å’Œå›¾æ ‡ä»£è¡¨ä¸åŒçš„èŠ‚ç‚¹çŠ¶æ€</li>
                    <li>ç®—æ³•ä¼šé€æ­¥æ¢ç´¢èŠ‚ç‚¹ï¼Œç»¿è‰²è¡¨ç¤ºå¾…æ¢ç´¢ï¼Œç²‰è‰²è¡¨ç¤ºå·²æ¢ç´¢ï¼Œé»„è‰²è¡¨ç¤ºå½“å‰æ­£åœ¨å¤„ç†çš„èŠ‚ç‚¹</li>
                </ul>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color start">ğŸš©</div>
                    <span><strong>èµ·ç‚¹ (Start)</strong></span>
                </div>
                <div class="legend-item">
                    <div class="legend-color end">ğŸ¯</div>
                    <span><strong>ç»ˆç‚¹ (End)</strong></span>
                </div>
                <div class="legend-item">
                    <div class="legend-color wall">â¬›</div>
                    <span><strong>éšœç¢ç‰© (Wall)</strong></span>
                </div>
                <div class="legend-item">
                    <div class="legend-color path">â­</div>
                    <span><strong>æœ€ç»ˆè·¯å¾„ (Path)</strong></span>
                </div>
                <div class="legend-item">
                    <div class="legend-color open">â—‹</div>
                    <span><strong>å¼€æ”¾åˆ—è¡¨ (Open Set)</strong> - å¾…æ¢ç´¢</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color closed">âœ•</div>
                    <span><strong>å…³é—­åˆ—è¡¨ (Closed Set)</strong> - å·²æ¢ç´¢</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color current">ğŸ“</div>
                    <span><strong>å½“å‰èŠ‚ç‚¹ (Current)</strong> - æ­£åœ¨å¤„ç†</span>
                </div>
            </div>

            <!-- æƒ…å¢ƒåˆ‡æ¢ Tab -->
            <div class="scenario-tabs">
                <div class="scenario-tab active" onclick="setScenario('near', this)">æƒ…å¢ƒä¸€ï¼šè¿‘è·ç¦»ç›®æ ‡</div>
                <div class="scenario-tab" onclick="setScenario('corridor', this)">æƒ…å¢ƒäºŒï¼šç‹­é•¿èµ°å»Š</div>
                <div class="scenario-tab" onclick="setScenario('heuristicGood', this)">æƒ…å¢ƒä¸‰ï¼šå¥½å¯å‘ (Manhattan)</div>
                <div class="scenario-tab" onclick="setScenario('heuristicBad', this)">æƒ…å¢ƒä¸‰ï¼šåå¯å‘ (h=0)</div>
            </div>

            <div class="button-group">
                <button onclick="startVisualization()">å¼€å§‹æ¼”ç¤º</button>
                <button onclick="resetGrid()">é‡ç½®</button>
                <button onclick="stepByStep()">å•æ­¥æ‰§è¡Œ</button>
            </div>

            <div id="grid" class="grid-container"></div>
            <div id="info" style="text-align: center; margin-top: 25px; padding: 15px; background: #e3f2fd; border-radius: 8px; font-size: 1.1em; color: #1976d2; font-weight: 500; border: 2px solid #90caf9;"></div>
            <div id="stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                <div style="padding: 15px; background: #f5f5f5; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">å¼€æ”¾åˆ—è¡¨èŠ‚ç‚¹æ•°</div>
                    <div id="openCount" style="font-size: 1.5em; font-weight: bold; color: #4CAF50;">0</div>
                </div>
                <div style="padding: 15px; background: #f5f5f5; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">å…³é—­åˆ—è¡¨èŠ‚ç‚¹æ•°</div>
                    <div id="closedCount" style="font-size: 1.5em; font-weight: bold; color: #f44336;">0</div>
                </div>
                <div style="padding: 15px; background: #f5f5f5; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">è·¯å¾„é•¿åº¦</div>
                    <div id="pathLength" style="font-size: 1.5em; font-weight: bold; color: #2196F3;">-</div>
                </div>
            </div>
        </div>

        <!-- 5. å¯å‘å¼å‡½æ•° -->
        <div class="section">
            <h2>5. å¸¸ç”¨å¯å‘å¼å‡½æ•°</h2>
            
            <h3>5.1 æ›¼å“ˆé¡¿è·ç¦»ï¼ˆManhattan Distanceï¼‰</h3>
            <p>é€‚ç”¨äºåªèƒ½ä¸Šä¸‹å·¦å³ç§»åŠ¨çš„ç½‘æ ¼åœ°å›¾ï¼š</p>
            <div class="formula">
                h(n) = |xâ‚ - xâ‚‚| + |yâ‚ - yâ‚‚|
            </div>
            <pre><code>function manhattanDistance(node, goal) {
    return Math.abs(node.x - goal.x) + Math.abs(node.y - goal.y);
}</code></pre>

            <h3>5.2 æ¬§å‡ é‡Œå¾—è·ç¦»ï¼ˆEuclidean Distanceï¼‰</h3>
            <p>é€‚ç”¨äºå¯ä»¥æ–œå‘ç§»åŠ¨çš„åœ°å›¾ï¼š</p>
            <div class="formula">
                h(n) = âˆš[(xâ‚ - xâ‚‚)Â² + (yâ‚ - yâ‚‚)Â²]
            </div>
            <pre><code>function euclideanDistance(node, goal) {
    const dx = node.x - goal.x;
    const dy = node.y - goal.y;
    return Math.sqrt(dx * dx + dy * dy);
}</code></pre>

            <h3>5.3 åˆ‡æ¯”é›ªå¤«è·ç¦»ï¼ˆChebyshev Distanceï¼‰</h3>
            <p>é€‚ç”¨äºå¯ä»¥å…«æ–¹å‘ç§»åŠ¨çš„åœ°å›¾ï¼š</p>
            <div class="formula">
                h(n) = max(|xâ‚ - xâ‚‚|, |yâ‚ - yâ‚‚|)
            </div>
            <pre><code>function chebyshevDistance(node, goal) {
    return Math.max(
        Math.abs(node.x - goal.x),
        Math.abs(node.y - goal.y)
    );
}</code></pre>
        </div>

        <!-- 6. ä¼ªä»£ç  -->
        <div class="section">
            <h2>6. å®Œæ•´ä¼ªä»£ç </h2>
            <pre><code>function AStar(start, goal):
    // åˆå§‹åŒ–
    openSet = [start]
    closedSet = []
    gScore = {start: 0}
    fScore = {start: heuristic(start, goal)}
    cameFrom = {}
    
    while openSet is not empty:
        // é€‰æ‹© f(n) æœ€å°çš„èŠ‚ç‚¹
        current = node in openSet with lowest fScore
        
        if current == goal:
            return reconstructPath(cameFrom, current)
        
        openSet.remove(current)
        closedSet.add(current)
        
        // æ¢ç´¢é‚»å±…
        for each neighbor of current:
            if neighbor in closedSet:
                continue
            
            if neighbor is obstacle:
                continue
            
            // è®¡ç®—æ–°çš„ g å€¼
            tentative_gScore = gScore[current] + distance(current, neighbor)
            
            if neighbor not in openSet:
                openSet.add(neighbor)
            else if tentative_gScore >= gScore[neighbor]:
                continue  // è¿™ä¸æ˜¯æ›´å¥½çš„è·¯å¾„
            
            // æ‰¾åˆ°æ›´å¥½çš„è·¯å¾„ï¼Œæ›´æ–°
            cameFrom[neighbor] = current
            gScore[neighbor] = tentative_gScore
            fScore[neighbor] = gScore[neighbor] + heuristic(neighbor, goal)
    
    return null  // æ²¡æœ‰æ‰¾åˆ°è·¯å¾„

function reconstructPath(cameFrom, current):
    path = [current]
    while current in cameFrom:
        current = cameFrom[current]
        path.prepend(current)
    return path</code></pre>
        </div>

        <!-- 7. æ—¶é—´å¤æ‚åº¦ -->
        <div class="section">
            <h2>7. ç®—æ³•å¤æ‚åº¦</h2>
            <table class="comparison-table">
                <tr>
                    <th>å¤æ‚åº¦ç±»å‹</th>
                    <th>å€¼</th>
                    <th>è¯´æ˜</th>
                </tr>
                <tr>
                    <td><strong>æ—¶é—´å¤æ‚åº¦</strong></td>
                    <td>O(b^d)</td>
                    <td>b æ˜¯åˆ†æ”¯å› å­ï¼Œd æ˜¯è§£çš„æ·±åº¦ã€‚æœ€åæƒ…å†µä¸‹éœ€è¦æ¢ç´¢æ‰€æœ‰èŠ‚ç‚¹</td>
                </tr>
                <tr>
                    <td><strong>ç©ºé—´å¤æ‚åº¦</strong></td>
                    <td>O(b^d)</td>
                    <td>éœ€è¦å­˜å‚¨å¼€æ”¾åˆ—è¡¨å’Œå…³é—­åˆ—è¡¨ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹</td>
                </tr>
                <tr>
                    <td><strong>æœ€ä¼˜æ€§</strong></td>
                    <td>âœ“ ä¿è¯</td>
                    <td>å½“å¯å‘å¼å‡½æ•°å¯æ¥å—æ—¶ï¼Œä¿è¯æ‰¾åˆ°æœ€ä¼˜è§£</td>
                </tr>
                <tr>
                    <td><strong>å®Œå¤‡æ€§</strong></td>
                    <td>âœ“ ä¿è¯</td>
                    <td>å¦‚æœå­˜åœ¨è§£ï¼Œä¸€å®šèƒ½æ‰¾åˆ°</td>
                </tr>
            </table>
        </div>

        <!-- 8. ä¸å…¶ä»–ç®—æ³•æ¯”è¾ƒ -->
        <div class="section">
            <h2>8. ä¸å…¶ä»–ç®—æ³•æ¯”è¾ƒ</h2>
            <table class="comparison-table">
                <tr>
                    <th>ç®—æ³•</th>
                    <th>ä¼˜ç‚¹</th>
                    <th>ç¼ºç‚¹</th>
                    <th>é€‚ç”¨åœºæ™¯</th>
                </tr>
                <tr>
                    <td><strong>A*</strong></td>
                    <td>æœ€ä¼˜è§£ã€æ•ˆç‡é«˜ã€ä½¿ç”¨å¯å‘å¼</td>
                    <td>éœ€è¦å¥½çš„å¯å‘å¼å‡½æ•°</td>
                    <td>è·¯å¾„è§„åˆ’ã€æ¸¸æˆAI</td>
                </tr>
                <tr>
                    <td><strong>Dijkstra</strong></td>
                    <td>ä¿è¯æœ€ä¼˜è§£ã€æ— éœ€å¯å‘å¼</td>
                    <td>é€Ÿåº¦æ…¢ã€æ¢ç´¢æ‰€æœ‰æ–¹å‘</td>
                    <td>å•æºæœ€çŸ­è·¯å¾„</td>
                </tr>
                <tr>
                    <td><strong>BFS</strong></td>
                    <td>ç®€å•ã€ä¿è¯æœ€çŸ­è·¯å¾„ï¼ˆè¾¹æƒä¸º1ï¼‰</td>
                    <td>æ•ˆç‡ä½ã€æ— æƒé‡æ”¯æŒ</td>
                    <td>æ— æƒå›¾æœ€çŸ­è·¯å¾„</td>
                </tr>
                <tr>
                    <td><strong>è´ªå¿ƒæœ€ä½³ä¼˜å…ˆ</strong></td>
                    <td>é€Ÿåº¦å¿«</td>
                    <td>ä¸ä¿è¯æœ€ä¼˜è§£</td>
                    <td>è¿‘ä¼¼è§£å³å¯çš„åœºæ™¯</td>
                </tr>
            </table>
        </div>

        <!-- 9. å®é™…åº”ç”¨ -->
        <div class="section">
            <h2>9. å®é™…åº”ç”¨åœºæ™¯</h2>
            <ul style="margin-left: 20px; line-height: 2;">
                <li>ğŸ® <strong>æ¸¸æˆå¼€å‘ï¼š</strong>NPCå¯»è·¯ã€å•ä½ç§»åŠ¨</li>
                <li>ğŸ—ºï¸ <strong>åœ°å›¾å¯¼èˆªï¼š</strong>GPSè·¯å¾„è§„åˆ’ã€è·¯çº¿ä¼˜åŒ–</li>
                <li>ğŸ¤– <strong>æœºå™¨äººå¯¼èˆªï¼š</strong>ç§»åŠ¨æœºå™¨äººè·¯å¾„è§„åˆ’</li>
                <li>ğŸ“¦ <strong>ç‰©æµä¼˜åŒ–ï¼š</strong>ä»“åº“æ‹£è´§è·¯å¾„ã€é…é€è·¯çº¿</li>
                <li>ğŸŒ <strong>ç½‘ç»œè·¯ç”±ï¼š</strong>æ•°æ®åŒ…è½¬å‘è·¯å¾„é€‰æ‹©</li>
                <li>ğŸ§© <strong>æ‹¼å›¾æ¸¸æˆï¼š</strong>æ±‚è§£æœ€ä¼˜ç§»åŠ¨åºåˆ—</li>
            </ul>
        </div>

        <!-- 10. ä¼˜åŒ–æŠ€å·§ -->
        <div class="section">
            <h2>10. ä¼˜åŒ–æŠ€å·§</h2>
            <h3>10.1 ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—</h3>
            <p>ä½¿ç”¨äºŒå‰å †æˆ–æ–æ³¢é‚£å¥‘å †å®ç°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå¯ä»¥å¿«é€Ÿè·å– f(n) æœ€å°çš„èŠ‚ç‚¹ã€‚</p>

            <h3>10.2 åŒå‘æœç´¢</h3>
            <p>åŒæ—¶ä»èµ·ç‚¹å’Œç»ˆç‚¹å¼€å§‹æœç´¢ï¼Œå½“ä¸¤ä¸ªæœç´¢ç›¸é‡æ—¶åœæ­¢ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘æœç´¢ç©ºé—´ã€‚</p>

            <h3>10.3 IDA*ï¼ˆè¿­ä»£åŠ æ·±A*ï¼‰</h3>
            <p>ç»“åˆäº†è¿­ä»£åŠ æ·±æœç´¢å’ŒA*ç®—æ³•ï¼Œå†…å­˜å ç”¨æ›´å°ï¼Œé€‚åˆå†…å­˜å—é™çš„åœºæ™¯ã€‚</p>

            <h3>10.4 JPSï¼ˆJump Point Searchï¼‰</h3>
            <p>ä¸“é—¨é’ˆå¯¹ç½‘æ ¼åœ°å›¾çš„ä¼˜åŒ–ï¼Œå¯ä»¥è·³è¿‡å¤§é‡ä¸å¿…è¦çš„èŠ‚ç‚¹ã€‚</p>
        </div>
    </div>

    <script>
        // ç½‘æ ¼å¤§å°
        const ROWS = 10;
        const COLS = 10;
        
        // èŠ‚ç‚¹çŠ¶æ€
        const EMPTY = 0;
        const WALL = 1;
        const START = 2;
        const END = 3;
        const PATH = 4;
        const OPEN = 5;
        const CLOSED = 6;
        const CURRENT = 7;

        let grid = [];
        let startNode = {x: 0, y: 0};
        let endNode = {x: 9, y: 9};
        let visualizationStep = 0;
        let visualizationData = [];
        let isRunning = false;
        let nodeValues = {}; // å­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹çš„ f, g, h å€¼
        let wallsConfig = []; // å½“å‰æƒ…å¢ƒçš„å¢™é…ç½®
        let heuristicMode = 'manhattan'; // 'manhattan' æˆ– 'none'
        let currentScenario = 'near';

        // åˆå§‹åŒ–ç½‘æ ¼
        function initGrid() {
            grid = [];
            for (let i = 0; i < ROWS; i++) {
                grid[i] = [];
                for (let j = 0; j < COLS; j++) {
                    grid[i][j] = EMPTY;
                }
            }
            
            // è®¾ç½®èµ·ç‚¹å’Œç»ˆç‚¹
            grid[startNode.y][startNode.x] = START;
            grid[endNode.y][endNode.x] = END;
            
            // æ ¹æ®å½“å‰æƒ…å¢ƒçš„å¢™é…ç½®æ·»åŠ éšœç¢ç‰©
            if (Array.isArray(wallsConfig)) {
                wallsConfig.forEach(([x, y]) => {
                    if (grid[y] && grid[y][x] === EMPTY) {
                        grid[y][x] = WALL;
                    }
                });
            }
            
            renderGrid();
        }

        // æ¸²æŸ“ç½‘æ ¼
        function renderGrid() {
            const gridDiv = document.getElementById('grid');
            gridDiv.innerHTML = '';
            
            for (let i = 0; i < ROWS; i++) {
                for (let j = 0; j < COLS; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.id = `cell-${i}-${j}`;
                    
                    // åˆ›å»ºå›¾æ ‡å…ƒç´ 
                    const icon = document.createElement('div');
                    icon.className = 'icon';
                    
                    // åˆ›å»ºåæ ‡å…ƒç´ 
                    const coords = document.createElement('div');
                    coords.className = 'coords';
                    coords.textContent = `(${j},${i})`;
                    
                    // åˆ›å»ºå€¼æ˜¾ç¤ºå…ƒç´ 
                    const values = document.createElement('div');
                    values.className = 'values';
                    
                    const state = grid[i][j];
                    const nodeKey = `${j},${i}`;
                    const valuesData = nodeValues[nodeKey];
                    
                    if (state === START) {
                        cell.classList.add('start');
                        icon.textContent = 'ğŸš©';
                    } else if (state === END) {
                        cell.classList.add('end');
                        icon.textContent = 'ğŸ¯';
                    } else if (state === WALL) {
                        cell.classList.add('wall');
                        icon.textContent = 'â¬›';
                    } else if (state === PATH) {
                        cell.classList.add('path');
                        icon.textContent = 'â­';
                    } else if (state === OPEN) {
                        cell.classList.add('open');
                        icon.textContent = 'â—‹';
                    } else if (state === CLOSED) {
                        cell.classList.add('closed');
                        icon.textContent = 'âœ•';
                    } else if (state === CURRENT) {
                        cell.classList.add('current');
                        icon.textContent = 'ğŸ“';
                    } else {
                        cell.classList.add('empty');
                        // ç©ºå•å…ƒæ ¼ä¸æ˜¾ç¤ºå›¾æ ‡ï¼Œåªæ˜¾ç¤ºåæ ‡
                    }
                    
                    // æ˜¾ç¤º f, g, h å€¼ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                    if (valuesData && (state === OPEN || state === CLOSED || state === CURRENT || state === PATH)) {
                        values.innerHTML = `
                            <div class="f-value">f=${valuesData.f}</div>
                            <div class="g-value">g=${valuesData.g}</div>
                            <div class="h-value">h=${valuesData.h}</div>
                        `;
                    }
                    
                    cell.appendChild(icon);
                    cell.appendChild(coords);
                    if (values.innerHTML) {
                        cell.appendChild(values);
                    }
                    gridDiv.appendChild(cell);
                }
            }
        }

        // å¯å‘å¼å‡½æ•°ï¼ˆæ”¯æŒå¤šç§æ¨¡å¼ï¼‰
        function heuristic(node, goal) {
            if (heuristicMode === 'none') {
                // å¯å‘å¼ä¸º 0ï¼Œç›¸å½“äº Dijkstraï¼šä¸â€œæ‹‰å‘ç»ˆç‚¹â€ï¼Œæœç´¢æ›´å‡åŒ€æ‰©æ•£
                return 0;
            }
            // é»˜è®¤ï¼šæ›¼å“ˆé¡¿è·ç¦»ï¼Œé€‚åˆåªèƒ½ä¸Šä¸‹å·¦å³ç§»åŠ¨çš„ç½‘æ ¼
            return Math.abs(node.x - goal.x) + Math.abs(node.y - goal.y);
        }

        // å„ç§æƒ…å¢ƒçš„é…ç½®
        const scenarios = {
            // æƒ…å¢ƒä¸€ï¼šè¿‘è·ç¦»ç›®æ ‡ï¼Œåªä¼šè¯„ä¼°ä¸€å°å—åŒºåŸŸ
            near: {
                heuristicMode: 'manhattan',
                start: { x: 1, y: 1 },
                end:   { x: 3, y: 2 },
                walls: []
            },

            // æƒ…å¢ƒäºŒï¼šç‹­é•¿èµ°å»Šï¼Œåªä¼šæ²¿ç€é€šé“è¯„ä¼°
            corridor: {
                heuristicMode: 'manhattan',
                start: { x: 0, y: 5 },
                end:   { x: 9, y: 5 },
                walls: (function () {
                    const arr = [];
                    for (let x = 0; x < COLS; x++) {
                        arr.push([x, 4]); // ä¸Šæ’å¢™
                        arr.push([x, 6]); // ä¸‹æ’å¢™
                    }
                    return arr;
                })()
            },

            // æƒ…å¢ƒä¸‰ï¼ˆå¥½å¯å‘ï¼‰ï¼šè¾ƒå¤æ‚åœ°å›¾ + æ›¼å“ˆé¡¿
            heuristicGood: {
                heuristicMode: 'manhattan',
                start: { x: 0, y: 0 },
                end:   { x: 9, y: 9 },
                walls: [
                    [2, 2], [2, 3], [2, 4],
                    [5, 5], [5, 6], [5, 7],
                    [7, 2], [7, 3], [7, 4], [7, 5],
                    [3, 7], [4, 7], [5, 7]
                ]
            },

            // æƒ…å¢ƒä¸‰ï¼ˆåå¯å‘ï¼‰ï¼šåŒä¸€å¼ å›¾ + h=0
            heuristicBad: {
                heuristicMode: 'none',
                start: { x: 0, y: 0 },
                end:   { x: 9, y: 9 },
                walls: [
                    [2, 2], [2, 3], [2, 4],
                    [5, 5], [5, 6], [5, 7],
                    [7, 2], [7, 3], [7, 4], [7, 5],
                    [3, 7], [4, 7], [5, 7]
                ]
            }
        };

        // å¥—ç”¨æŸä¸ªæƒ…å¢ƒé…ç½®
        function applyScenario(name) {
            const cfg = scenarios[name];
            if (!cfg) {
                return;
            }

            currentScenario = name;
            heuristicMode = cfg.heuristicMode;
            startNode = { ...cfg.start };
            endNode = { ...cfg.end };
            wallsConfig = cfg.walls.map(([x, y]) => [x, y]);

            nodeValues = {};
            initGrid();
            updateStats(0, 0, null);

            const info = document.getElementById('info');
            if (!info) {
                return;
            }
            if (name === 'near') {
                info.textContent = 'æƒ…å¢ƒä¸€ï¼šèµ·ç‚¹ä¸ç»ˆç‚¹å¾ˆè¿‘ï¼Œåªä¼šè¯„ä¼°é™„è¿‘å°‘é‡èŠ‚ç‚¹ã€‚';
            } else if (name === 'corridor') {
                info.textContent = 'æƒ…å¢ƒäºŒï¼šç‹­é•¿èµ°å»Šï¼ŒèŠ‚ç‚¹è¯„ä¼°é›†ä¸­åœ¨é€šé“ä¸Šã€‚';
            } else if (name === 'heuristicGood') {
                info.textContent = 'æƒ…å¢ƒä¸‰ï¼ˆå¥½å¯å‘ï¼‰ï¼šä½¿ç”¨æ›¼å“ˆé¡¿è·ç¦»ï¼Œè¯„ä¼°åŒºåŸŸæ›´è´´è¿‘èµ·ç‚¹â†’ç»ˆç‚¹æ–¹å‘ã€‚';
            } else if (name === 'heuristicBad') {
                info.textContent = 'æƒ…å¢ƒä¸‰ï¼ˆåå¯å‘ï¼‰ï¼šh=0ï¼Œç›¸å½“äº Dijkstraï¼Œä¼šè¯„ä¼°æ›´å¤šèŠ‚ç‚¹å‘å››å‘¨æ‰©æ•£ã€‚';
            }
        }

        // Tab ç‚¹å‡»ï¼šæ›´æ–°æ ·å¼å¹¶åˆ‡æ¢æƒ…å¢ƒ
        function setScenario(name, el) {
            const tabs = document.querySelectorAll('.scenario-tab');
            tabs.forEach(t => t.classList.remove('active'));
            if (el) {
                el.classList.add('active');
            }

            // åœæ­¢å½“å‰åŠ¨ç”»å¹¶æ¸…ç©ºæ­¥éª¤
            isRunning = false;
            visualizationStep = 0;
            visualizationData = [];

            applyScenario(name);
        }

        // A* ç®—æ³•å®ç°ï¼ˆç”¨äºç”Ÿæˆå¯è§†åŒ–æ•°æ®ï¼‰
        function aStar() {
            const openSet = [{x: startNode.x, y: startNode.y, g: 0, h: heuristic(startNode, endNode), f: heuristic(startNode, endNode)}];
            const closedSet = new Set();
            const cameFrom = {};
            const gScore = {};
            const fScore = {};
            
            const key = (x, y) => `${x},${y}`;
            gScore[key(startNode.x, startNode.y)] = 0;
            fScore[key(startNode.x, startNode.y)] = heuristic(startNode, endNode);
            
            const steps = [];
            
            while (openSet.length > 0) {
                // é€‰æ‹© f å€¼æœ€å°çš„èŠ‚ç‚¹
                openSet.sort((a, b) => a.f - b.f);
                const current = openSet.shift();
                const currentKey = key(current.x, current.y);
                
                // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ç»ˆç‚¹
                if (current.x === endNode.x && current.y === endNode.y) {
                    // é‡æ„è·¯å¾„
                    const path = [];
                    let node = currentKey;
                    while (node) {
                        const [x, y] = node.split(',').map(Number);
                        path.unshift({x, y});
                        node = cameFrom[node];
                    }
                    // è®°å½•å½“å‰æ­¥éª¤ï¼ˆåœ¨åŠ å…¥closedSetä¹‹å‰ï¼‰
                    const currentValues = {
                        f: fScore[currentKey],
                        g: gScore[currentKey],
                        h: fScore[currentKey] - gScore[currentKey]
                    };
                    steps.push({
                        type: 'current',
                        node: {x: current.x, y: current.y, ...currentValues},
                        openSet: openSet.map(n => {
                            const nKey = key(n.x, n.y);
                            return {
                                x: n.x,
                                y: n.y,
                                f: fScore[nKey],
                                g: gScore[nKey],
                                h: fScore[nKey] - gScore[nKey]
                            };
                        }),
                        closedSet: Array.from(closedSet).map(k => {
                            const [x, y] = k.split(',').map(Number);
                            return {
                                x, y,
                                f: fScore[k],
                                g: gScore[k],
                                h: fScore[k] - gScore[k]
                            };
                        })
                    });
                    steps.push({type: 'path', path, closedSet: Array.from(closedSet).concat([currentKey]).map(k => {
                        const [x, y] = k.split(',').map(Number);
                        return {x, y};
                    })});
                    return steps;
                }
                
                // è®°å½•å½“å‰æ­¥éª¤ï¼ˆåœ¨åŠ å…¥closedSetä¹‹å‰ï¼‰
                const currentValues = {
                    f: fScore[currentKey],
                    g: gScore[currentKey],
                    h: fScore[currentKey] - gScore[currentKey]
                };
                steps.push({
                    type: 'current',
                    node: {x: current.x, y: current.y, ...currentValues},
                    openSet: openSet.map(n => {
                        const nKey = key(n.x, n.y);
                        return {
                            x: n.x,
                            y: n.y,
                            f: fScore[nKey],
                            g: gScore[nKey],
                            h: fScore[nKey] - gScore[nKey]
                        };
                    }),
                    closedSet: Array.from(closedSet).map(k => {
                        const [x, y] = k.split(',').map(Number);
                        return {
                            x, y,
                            f: fScore[k],
                            g: gScore[k],
                            h: fScore[k] - gScore[k]
                        };
                    })
                });
                
                closedSet.add(currentKey);
                
                // æ¢ç´¢é‚»å±…ï¼ˆä¸Šä¸‹å·¦å³ï¼‰
                const neighbors = [
                    {x: current.x, y: current.y - 1},
                    {x: current.x, y: current.y + 1},
                    {x: current.x - 1, y: current.y},
                    {x: current.x + 1, y: current.y}
                ];
                
                for (const neighbor of neighbors) {
                    const nKey = key(neighbor.x, neighbor.y);
                    
                    // è¾¹ç•Œæ£€æŸ¥
                    if (neighbor.x < 0 || neighbor.x >= COLS || neighbor.y < 0 || neighbor.y >= ROWS) {
                        continue;
                    }
                    
                    // éšœç¢ç‰©æ£€æŸ¥
                    if (grid[neighbor.y][neighbor.x] === WALL) {
                        continue;
                    }
                    
                    // å·²åœ¨å…³é—­åˆ—è¡¨ä¸­
                    if (closedSet.has(nKey)) {
                        continue;
                    }
                    
                    const tentativeG = gScore[currentKey] + 1;
                    
                    if (!gScore[nKey] || tentativeG < gScore[nKey]) {
                        cameFrom[nKey] = currentKey;
                        gScore[nKey] = tentativeG;
                        fScore[nKey] = tentativeG + heuristic(neighbor, endNode);
                        
                        // å¦‚æœä¸åœ¨å¼€æ”¾åˆ—è¡¨ä¸­ï¼Œæ·»åŠ 
                        if (!openSet.find(n => n.x === neighbor.x && n.y === neighbor.y)) {
                            openSet.push({
                                x: neighbor.x,
                                y: neighbor.y,
                                g: tentativeG,
                                h: heuristic(neighbor, endNode),
                                f: fScore[nKey]
                            });
                        }
                    }
                }
            }
            
            return steps;
        }

        // å¼€å§‹å¯è§†åŒ–
        function startVisualization() {
            if (isRunning) return;
            isRunning = true;
            visualizationStep = 0;
            nodeValues = {};
            visualizationData = aStar();
            
            // é‡ç½®ç½‘æ ¼æ˜¾ç¤ºçŠ¶æ€
            for (let i = 0; i < ROWS; i++) {
                for (let j = 0; j < COLS; j++) {
                    if (grid[i][j] !== START && grid[i][j] !== END && grid[i][j] !== WALL) {
                        grid[i][j] = EMPTY;
                    }
                }
            }
            
            animateVisualization();
        }

        // åŠ¨ç”»å¯è§†åŒ–
        function animateVisualization() {
            if (visualizationStep >= visualizationData.length) {
                isRunning = false;
                return;
            }
            
            const step = visualizationData[visualizationStep];
            
            if (step.type === 'current') {
                // æ¸…é™¤ä¹‹å‰çš„å½“å‰èŠ‚ç‚¹æ ‡è®°
                for (let i = 0; i < ROWS; i++) {
                    for (let j = 0; j < COLS; j++) {
                        if (grid[i][j] === CURRENT) {
                            grid[i][j] = CLOSED;
                        }
                    }
                }
                
                // æ›´æ–°èŠ‚ç‚¹å€¼
                if (step.node.f !== undefined) {
                    const nodeKey = `${step.node.x},${step.node.y}`;
                    nodeValues[nodeKey] = {
                        f: step.node.f,
                        g: step.node.g,
                        h: step.node.h
                    };
                }
                
                // æ ‡è®°å¼€æ”¾åˆ—è¡¨
                step.openSet.forEach(n => {
                    if (grid[n.y][n.x] === EMPTY) {
                        grid[n.y][n.x] = OPEN;
                    }
                    // æ›´æ–°å¼€æ”¾åˆ—è¡¨èŠ‚ç‚¹çš„å€¼
                    if (n.f !== undefined) {
                        const nodeKey = `${n.x},${n.y}`;
                        nodeValues[nodeKey] = {
                            f: n.f,
                            g: n.g,
                            h: n.h
                        };
                    }
                });
                
                // æ ‡è®°å…³é—­åˆ—è¡¨
                step.closedSet.forEach(n => {
                    if (grid[n.y][n.x] !== START && grid[n.y][n.x] !== END) {
                        grid[n.y][n.x] = CLOSED;
                    }
                    // æ›´æ–°å…³é—­åˆ—è¡¨èŠ‚ç‚¹çš„å€¼
                    if (n.f !== undefined) {
                        const nodeKey = `${n.x},${n.y}`;
                        nodeValues[nodeKey] = {
                            f: n.f,
                            g: n.g,
                            h: n.h
                        };
                    }
                });
                
                // æ ‡è®°å½“å‰èŠ‚ç‚¹
                if (grid[step.node.y][step.node.x] !== START && grid[step.node.y][step.node.x] !== END) {
                    grid[step.node.y][step.node.x] = CURRENT;
                }
                
                renderGrid();
                updateStats(step.openSet.length, step.closedSet.length + 1, null);
                document.getElementById('info').textContent = 
                    `æ­¥éª¤ ${visualizationStep + 1}/${visualizationData.length}: æ­£åœ¨æ¢ç´¢èŠ‚ç‚¹ (${step.node.x}, ${step.node.y}) f=${step.node.f || '?'} g=${step.node.g || '?'} h=${step.node.h || '?'}`;
                
                visualizationStep++;
                setTimeout(() => animateVisualization(), 300);
            } else if (step.type === 'path') {
                // æ˜¾ç¤ºæœ€ç»ˆè·¯å¾„
                const closedCount = step.closedSet ? step.closedSet.length : 0;
                step.path.forEach((node, index) => {
                    if (grid[node.y][node.x] !== START && grid[node.y][node.x] !== END) {
                        setTimeout(() => {
                            grid[node.y][node.x] = PATH;
                            renderGrid();
                            if (index === step.path.length - 1) {
                                updateStats(0, closedCount, step.path.length - 1);
                                document.getElementById('info').textContent = 
                                    `âœ… æ‰¾åˆ°è·¯å¾„ï¼è·¯å¾„é•¿åº¦ï¼š${step.path.length - 1} æ­¥`;
                                isRunning = false;
                            }
                        }, index * 100);
                    }
                });
            }
        }

        // å•æ­¥æ‰§è¡Œ
        function stepByStep() {
            if (visualizationData.length === 0) {
                nodeValues = {};
                visualizationData = aStar();
                for (let i = 0; i < ROWS; i++) {
                    for (let j = 0; j < COLS; j++) {
                        if (grid[i][j] !== START && grid[i][j] !== END && grid[i][j] !== WALL) {
                            grid[i][j] = EMPTY;
                        }
                    }
                }
            }
            
            if (visualizationStep >= visualizationData.length) {
                return;
            }
            
            const step = visualizationData[visualizationStep];
            
            if (step.type === 'current') {
                // æ¸…é™¤ä¹‹å‰çš„å½“å‰èŠ‚ç‚¹æ ‡è®°
                for (let i = 0; i < ROWS; i++) {
                    for (let j = 0; j < COLS; j++) {
                        if (grid[i][j] === CURRENT) {
                            grid[i][j] = CLOSED;
                        }
                    }
                }
                
                // æ›´æ–°èŠ‚ç‚¹å€¼
                if (step.node.f !== undefined) {
                    const nodeKey = `${step.node.x},${step.node.y}`;
                    nodeValues[nodeKey] = {
                        f: step.node.f,
                        g: step.node.g,
                        h: step.node.h
                    };
                }
                
                // æ ‡è®°å¼€æ”¾åˆ—è¡¨
                step.openSet.forEach(n => {
                    if (grid[n.y][n.x] === EMPTY) {
                        grid[n.y][n.x] = OPEN;
                    }
                    // æ›´æ–°å¼€æ”¾åˆ—è¡¨èŠ‚ç‚¹çš„å€¼
                    if (n.f !== undefined) {
                        const nodeKey = `${n.x},${n.y}`;
                        nodeValues[nodeKey] = {
                            f: n.f,
                            g: n.g,
                            h: n.h
                        };
                    }
                });
                
                // æ ‡è®°å…³é—­åˆ—è¡¨
                step.closedSet.forEach(n => {
                    if (grid[n.y][n.x] !== START && grid[n.y][n.x] !== END) {
                        grid[n.y][n.x] = CLOSED;
                    }
                    // æ›´æ–°å…³é—­åˆ—è¡¨èŠ‚ç‚¹çš„å€¼
                    if (n.f !== undefined) {
                        const nodeKey = `${n.x},${n.y}`;
                        nodeValues[nodeKey] = {
                            f: n.f,
                            g: n.g,
                            h: n.h
                        };
                    }
                });
                
                // æ ‡è®°å½“å‰èŠ‚ç‚¹
                if (grid[step.node.y][step.node.x] !== START && grid[step.node.y][step.node.x] !== END) {
                    grid[step.node.y][step.node.x] = CURRENT;
                }
                
                renderGrid();
                updateStats(step.openSet.length, step.closedSet.length + 1, null);
                document.getElementById('info').textContent = 
                    `æ­¥éª¤ ${visualizationStep + 1}/${visualizationData.length}: æ­£åœ¨æ¢ç´¢èŠ‚ç‚¹ (${step.node.x}, ${step.node.y}) f=${step.node.f || '?'} g=${step.node.g || '?'} h=${step.node.h || '?'}`;
                
                visualizationStep++;
            } else if (step.type === 'path') {
                step.path.forEach((node, index) => {
                    if (grid[node.y][node.x] !== START && grid[node.y][node.x] !== END) {
                        grid[node.y][node.x] = PATH;
                    }
                });
                renderGrid();
                // è·å–å…³é—­åˆ—è¡¨å¤§å°
                const closedCount = step.closedSet ? step.closedSet.length : 0;
                updateStats(0, closedCount, step.path.length - 1);
                document.getElementById('info').textContent = 
                    `âœ… æ‰¾åˆ°è·¯å¾„ï¼è·¯å¾„é•¿åº¦ï¼š${step.path.length - 1} æ­¥`;
                visualizationStep = visualizationData.length;
            }
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats(openCount, closedCount, pathLength) {
            document.getElementById('openCount').textContent = openCount;
            document.getElementById('closedCount').textContent = closedCount;
            document.getElementById('pathLength').textContent = pathLength !== null ? pathLength : '-';
        }

        // é‡ç½®ç½‘æ ¼
        function resetGrid() {
            isRunning = false;
            visualizationStep = 0;
            visualizationData = [];
            nodeValues = {};
            applyScenario(currentScenario || 'near');
            document.getElementById('info').textContent = '';
            updateStats(0, 0, null);
        }

        // åˆå§‹åŒ–ï¼šé»˜è®¤ä½¿ç”¨æƒ…å¢ƒä¸€
        applyScenario('near');
    </script>
</body>
</html>