<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A* ç®—æ³•è©³è§£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", sans-serif;
            line-height: 1.6;
            color: #333;
            background: radial-gradient(circle at top left, #1d283a, #020617 55%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 40px;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 8px;
            font-size: 2.4em;
            letter-spacing: 0.02em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .back-link:hover {
            color: #764ba2;
        }

        h2 {
            color: #764ba2;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            font-size: 1.8em;
        }

        h3 {
            color: #555;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .formula {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
            border: 2px solid #667eea;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .formula code {
            font-size: 1.2em;
            color: #764ba2;
        }

        .step {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #764ba2;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #e83e8c;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
        }

        pre code {
            background: transparent;
            color: #f8f8f2;
            padding: 0;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(10, 70px);
            gap: 3px;
            margin: 20px auto;
            justify-content: center;
            padding: 25px;
            background: #e8e8e8;
            border-radius: 10px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }

        .cell {
            width: 70px;
            height: 70px;
            border: 2px solid #666;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.85em;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            border-radius: 4px;
            padding: 2px;
        }

        .cell .icon {
            font-size: 1.3em;
            line-height: 1;
            margin-bottom: 2px;
        }

        .cell .coords {
            font-size: 0.55em;
            opacity: 0.8;
            margin-top: 1px;
            font-weight: normal;
        }

        .cell .values {
            font-size: 0.5em;
            margin-top: 2px;
            line-height: 1.2;
            text-align: center;
        }

        .cell .values .f-value {
            font-weight: bold;
            color: inherit;
        }

        .cell .values .g-value {
            color: #1976d2;
        }

        .cell .values .h-value {
            color: #d32f2f;
        }

        .cell.start {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border-color: #2e7d32;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        .cell.start .icon::before {
            content: "ğŸš©";
        }

        .cell.end {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
            border-color: #c62828;
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
        }

        .cell.end .icon::before {
            content: "ğŸ¯";
        }

        .cell.wall {
            background: linear-gradient(135deg, #424242 0%, #212121 100%);
            color: white;
            border-color: #000;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
        }

        .cell.wall .icon::before {
            content: "â¬›";
        }

        .cell.path {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            border-color: #1565C0;
            box-shadow: 0 0 8px rgba(33, 150, 243, 0.6);
        }

        .cell.path .icon::before {
            content: "â­";
        }

        .cell.open {
            background: linear-gradient(135deg, #C8E6C9 0%, #A5D6A7 100%);
            border-color: #81C784;
            color: #2e7d32;
        }

        .cell.open .icon::before {
            content: "â—‹";
            color: #2e7d32;
        }

        .cell.closed {
            background: linear-gradient(135deg, #FFCDD2 0%, #EF9A9A 100%);
            border-color: #E57373;
            color: #c62828;
        }

        .cell.closed .icon::before {
            content: "âœ•";
            color: #c62828;
        }

        .cell.current {
            background: linear-gradient(135deg, #FFD700 0%, #FFC107 100%);
            border-color: #FFA000;
            color: #F57C00;
            animation: pulse 1s infinite;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            z-index: 10;
        }

        .cell.current .icon::before {
            content: "ğŸ“";
        }

        .cell.empty {
            background: #FAFAFA;
            border-color: #BDBDBD;
            color: #757575;
        }

        .cell.empty .coords {
            opacity: 1;
            font-weight: 500;
            color: #757575;
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            }
            50% { 
                transform: scale(1.15);
                box-shadow: 0 0 25px rgba(255, 215, 0, 1);
            }
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 25px 0;
            justify-content: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-weight: 500;
        }

        .legend-color {
            width: 40px;
            height: 40px;
            border: 2px solid #666;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .tip {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .warning {
            background: #fff3cd;
            border-left: 4px solid #856404;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .button-group {
            text-align: center;
            margin: 20px 0;
        }

        .scenario-tabs {
            display: flex;
            justify-content: center;
            margin: 10px auto 20px;
            gap: 8px;
            flex-wrap: wrap;
        }

        .scenario-tab {
            padding: 8px 14px;
            border-radius: 999px;
            border: 1px solid #667eea;
            color: #667eea;
            background: #fff;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }

        .scenario-tab:hover {
            background: #eef2ff;
        }

        .scenario-tab.active {
            background: #667eea;
            color: #fff;
            box-shadow: 0 2px 6px rgba(102, 126, 234, 0.6);
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            margin: 5px;
            transition: background 0.3s;
        }

        button:hover {
            background: #764ba2;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .float-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .float-btn {
            min-width: 120px;
            height: 50px;
            border-radius: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5), 0 0 0 2px rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
            padding: 0 20px;
        }

        .float-btn.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .float-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.7), 0 0 0 2px rgba(255, 255, 255, 0.2);
        }

        .float-btn:active {
            transform: translateY(-1px) scale(0.98);
        }

        .float-btn.back-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .float-btn.top-btn {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        .float-btn-icon {
            font-size: 18px;
            font-weight: bold;
        }

        .float-btn-text {
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        @media (max-width: 768px) {
            .float-button {
                bottom: 20px;
                right: 20px;
            }

            .float-btn {
                min-width: 100px;
                height: 44px;
                font-size: 14px;
                padding: 0 16px;
            }

            .float-btn-icon {
                font-size: 16px;
            }

            .float-btn-text {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é </a>
        
        <h1>ğŸš€ A* ç®—æ³•å®Œæ•´è©³è§£</h1>
        <p class="subtitle">å¾åŸç†åˆ°å¯¦ä½œï¼Œæ·±å…¥ç†è§£æœ€çŸ­è·¯å¾‘æœå°‹æ¼”ç®—æ³•</p>

        <!-- 1. ç®—æ³•æ¦‚è¿° -->
        <div class="section">
            <h2>1. ä»€éº¼æ˜¯ A* ç®—æ³•ï¼Ÿ</h2>
            <p>A*ï¼ˆA-Starï¼‰ç®—æ³•æ˜¯ä¸€ç¨®åœ¨åœ–å½¢ä¸­å°‹æ‰¾å¾èµ·é»åˆ°çµ‚é»çš„æœ€çŸ­è·¯å¾‘çš„å•Ÿç™¼å¼æœå°‹æ¼”ç®—æ³•ã€‚å®ƒçµåˆäº†<strong>Dijkstra æ¼”ç®—æ³•</strong>ï¼ˆä¿è­‰æ‰¾åˆ°æœ€çŸ­è·¯å¾‘ï¼‰å’Œ<strong>è²ªå¿ƒæœ€ä½³å„ªå…ˆæœå°‹</strong>ï¼ˆä½¿ç”¨å•Ÿç™¼å¼å‡½æ•¸åŠ é€Ÿæœå°‹ï¼‰çš„å„ªé»ã€‚</p>
            
            <div class="tip">
                <strong>ğŸ’¡ æ ¸å¿ƒæ€æƒ³ï¼š</strong>A* ç®—æ³•é€éè©•ä¼°å‡½æ•¸ f(n) = g(n) + h(n) ä¾†æ±ºå®šä¸‹ä¸€æ­¥è¦æ¢ç´¢å“ªå€‹ç¯€é»ï¼Œå…¶ä¸­ g(n) æ˜¯å¾èµ·é»åˆ°ç›®å‰ç¯€é»çš„å¯¦éš›ä»£åƒ¹ï¼Œh(n) æ˜¯å¾ç›®å‰ç¯€é»åˆ°çµ‚é»çš„ä¼°è¨ˆä»£åƒ¹ï¼ˆå•Ÿç™¼å¼å‡½æ•¸ï¼‰ã€‚
            </div>
        </div>

        <!-- 2. æ ¸å¿ƒå…¬å¼ -->
        <div class="section">
            <h2>2. æ ¸å¿ƒå…¬å¼</h2>
            <div class="formula">
                f(n) = g(n) + h(n)
            </div>
            
            <h3>2.1 å„åƒæ•¸å«ç¾©</h3>
            <ul style="margin-left: 20px; line-height: 2;">
                <li><span class="highlight">f(n)</span>ï¼šç¯€é» n çš„ç¸½è©•ä¼°å€¼ï¼ˆè¶Šå°è¶Šå¥½ï¼‰</li>
                <li><span class="highlight">g(n)</span>ï¼šå¾èµ·é»åˆ°ç¯€é» n çš„<strong>å¯¦éš›ä»£åƒ¹</strong>ï¼ˆå·²èµ°éçš„è·¯å¾‘é•·åº¦ï¼‰</li>
                <li><span class="highlight">h(n)</span>ï¼šå¾ç¯€é» n åˆ°çµ‚é»çš„<strong>ä¼°è¨ˆä»£åƒ¹</strong>ï¼ˆå•Ÿç™¼å¼å‡½æ•¸ï¼Œå¿…é ˆå¯æ¥å—ï¼‰</li>
            </ul>

            <div class="warning">
                <strong>âš ï¸ é‡è¦ç´„æŸï¼š</strong>å•Ÿç™¼å¼å‡½æ•¸ h(n) å¿…é ˆæ˜¯<strong>å¯æ¥å—çš„ï¼ˆadmissibleï¼‰</strong>ï¼Œä¹Ÿå°±æ˜¯å®ƒæ°¸é ä¸èƒ½é«˜ä¼°åˆ°é”çµ‚é»çš„å¯¦éš›ä»£åƒ¹ï¼Œé€™æ¨£æ‰èƒ½ä¿è­‰ A* ç®—æ³•æ‰¾åˆ°æœ€å„ªè§£ã€‚
            </div>
        </div>

        <!-- 3. ç®—æ³•æ­¥éª¤ -->
        <div class="section">
            <h2>3. ç®—æ³•è©³ç´°æ­¥é©Ÿ</h2>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>åˆå§‹åŒ–ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å»ºç«‹å…©å€‹é›†åˆï¼š<code>openSet</code>ï¼ˆå¾…æ¢ç´¢ç¯€é»ï¼‰å’Œ <code>closedSet</code>ï¼ˆå·²æ¢ç´¢ç¯€é»ï¼‰</li>
                    <li>å°‡èµ·é»åŠ å…¥ <code>openSet</code></li>
                    <li>è¨­å®šèµ·é»çš„ g(èµ·é») = 0ï¼Œf(èµ·é») = h(èµ·é»)</li>
                    <li>è¨˜éŒ„æ¯å€‹ç¯€é»çš„çˆ¶ç¯€é»ï¼ˆç”¨æ–¼å›æº¯è·¯å¾‘ï¼‰</li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">2</span>
                <strong>é‡è¤‡åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼Œç›´åˆ°æ‰¾åˆ°çµ‚é»æˆ– openSet ç‚ºç©ºï¼š</strong>
            </div>

            <div class="step">
                <span class="step-number">2.1</span>
                <strong>é¸æ“‡ç›®å‰ç¯€é»ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å¾ <code>openSet</code> ä¸­é¸å‡º f(n) å€¼æœ€å°çš„ç¯€é»ä½œç‚ºç›®å‰ç¯€é»</li>
                    <li>å¦‚æœ f(n) å€¼ç›¸åŒï¼Œé€šå¸¸é¸æ“‡ h(n) è¼ƒå°çš„ç¯€é»ï¼ˆæ›´æ¥è¿‘çµ‚é»ï¼‰</li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">2.2</span>
                <strong>æª¢æŸ¥æ˜¯å¦åˆ°é”çµ‚é»ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å¦‚æœç›®å‰ç¯€é»æ˜¯çµ‚é»ï¼Œ<strong>å›æº¯è·¯å¾‘</strong>ä¸¦å›å‚³çµæœ</li>
                    <li>å›æº¯æ–¹å¼ï¼šå¾çµ‚é»é–‹å§‹ï¼Œæ²¿è‘—çˆ¶ç¯€é»æŒ‡æ¨™ä¸€è·¯è¿½æº¯åˆ°èµ·é»</li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">2.3</span>
                <strong>è™•ç†ç›®å‰ç¯€é»ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å°‡ç›®å‰ç¯€é»å¾ <code>openSet</code> ç§»é™¤</li>
                    <li>å°‡ç›®å‰ç¯€é»åŠ å…¥ <code>closedSet</code></li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">2.4</span>
                <strong>æ¢ç´¢é„°å±…ç¯€é»ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>èµ°è¨ªç›®å‰ç¯€é»çš„æ‰€æœ‰é„°å±…ç¯€é»</li>
                    <li>ç•¥ééšœç¤™ç‰©èˆ‡å·²åœ¨ <code>closedSet</code> ä¸­çš„ç¯€é»</li>
                    <li>å°æ–¼æ¯å€‹é„°å±…ç¯€é»ï¼š
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>è¨ˆç®—å¾èµ·é»åˆ°è©²é„°å±…çš„æ–°ä»£åƒ¹ï¼š<code>tentative_g = g(ç›®å‰ç¯€é») + ç§»å‹•ä»£åƒ¹</code></li>
                            <li>å¦‚æœé„°å±…ä¸åœ¨ <code>openSet</code> ä¸­ï¼Œå°‡å…¶åŠ å…¥</li>
                            <li>å¦‚æœ <code>tentative_g < g(é„°å±…)</code>ï¼ˆæ‰¾åˆ°æ›´å¥½çš„è·¯å¾‘ï¼‰ï¼Œæ›´æ–°ï¼š
                                <ul style="margin-left: 20px; margin-top: 5px;">
                                    <li>g(é„°å±…) = tentative_g</li>
                                    <li>f(é„°å±…) = g(é„°å±…) + h(é„°å±…)</li>
                                    <li>çˆ¶ç¯€é»(é„°å±…) = ç›®å‰ç¯€é»</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">3</span>
                <strong>çµæŸï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å¦‚æœ <code>openSet</code> ç‚ºç©ºä¸”æœªæ‰¾åˆ°çµ‚é»ï¼Œä»£è¡¨<strong>ä¸å­˜åœ¨è·¯å¾‘</strong></li>
                    <li>å¦‚æœæ‰¾åˆ°çµ‚é»ï¼Œå›å‚³é‡å»ºå¾Œçš„è·¯å¾‘</li>
                </ul>
            </div>
        </div>

        <!-- 3.5 èŠ‚ç‚¹è¯„ä¼°ä¸è®¡ç®—è¯¦è§£ -->
        <div class="section">
            <h2>3.5 ç¯€é»è©•ä¼°èˆ‡è¨ˆç®—è©³è§£</h2>
            <p>é€™æ˜¯ A* ç®—æ³•çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œç†è§£ç¯€é»å¦‚ä½•è¢«è©•ä¼°èˆ‡è¨ˆç®—ï¼Œå°æ–¼æŒæ¡æ¼”ç®—æ³•è‡³é—œé‡è¦ã€‚</p>

            <h3>ğŸ“Š ç¯€é»è©•ä¼°çš„ä¸‰å€‹é—œéµæ•¸å€¼</h3>
            
            <div class="step">
                <h4 style="color: #667eea; margin-bottom: 10px;">1. g(n) - å¯¦éš›ä»£åƒ¹ï¼ˆå¾èµ·é»åˆ°ç›®å‰ç¯€é»çš„è·é›¢ï¼‰</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>å«ç¾©ï¼š</strong>å¾èµ·é»åˆ°ç¯€é» n çš„<strong>å¯¦éš›å·²èµ°è·¯å¾‘</strong>ä¹‹ç¸½ä»£åƒ¹</li>
                    <li><strong>è¨ˆç®—æ–¹å¼ï¼š</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>èµ·é»ï¼šg(èµ·é») = 0</li>
                            <li>å…¶ä»–ç¯€é»ï¼šg(ç¯€é») = g(çˆ¶ç¯€é») + ç§»å‹•ä»£åƒ¹</li>
                            <li>åœ¨ç¶²æ ¼åœ°åœ–ä¸­ï¼Œç›¸é„°ç¯€é»çš„ç§»å‹•ä»£åƒ¹é€šå¸¸ç‚º 1</li>
                        </ul>
                    </li>
                    <li><strong>ç‰¹é»ï¼š</strong>é€™å€‹æ•¸å€¼æ˜¯<strong>ç¢ºå®šä¸”ç²¾ç¢ºçš„</strong>ï¼Œå› ç‚ºæˆ‘å€‘å·²ç¶“å¯¦éš›èµ°éé€™æ¢è·¯å¾‘</li>
                </ul>
                
                <div style="background: #e8f5e9; padding: 15px; margin-top: 15px; border-radius: 8px; border-left: 4px solid #4CAF50;">
                    <strong>ğŸ’¡ ç¯„ä¾‹ï¼š</strong>å¦‚æœèµ·é»æ˜¯ (0,0)ï¼Œç›®å‰ç¯€é»æ˜¯ (2,1)ï¼Œè·¯å¾‘ç‚º (0,0) â†’ (1,0) â†’ (2,0) â†’ (2,1)
                    <br>é‚£éº¼ g(2,1) = 0 + 1 + 1 + 1 = <strong>3</strong>
                </div>
            </div>

            <div class="step">
                <h4 style="color: #667eea; margin-bottom: 10px;">2. h(n) - å•Ÿç™¼å¼ä¼°è¨ˆï¼ˆå¾ç›®å‰ç¯€é»åˆ°çµ‚é»çš„ä¼°è¨ˆè·é›¢ï¼‰</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>å«ç¾©ï¼š</strong>å¾ç¯€é» n åˆ°çµ‚é»çš„<strong>ä¼°è¨ˆä»£åƒ¹</strong>ï¼ˆå°šæœªå¯¦éš›èµ°éï¼‰</li>
                    <li><strong>è¨ˆç®—æ–¹å¼ï¼š</strong>ä½¿ç”¨å•Ÿç™¼å¼å‡½æ•¸ï¼Œå¸¸ç”¨æ›¼å“ˆé “è·é›¢ï¼š
                        <div class="formula" style="margin: 10px 0;">
                            h(n) = |xâ‚ - xâ‚‚| + |yâ‚ - yâ‚‚|
                        </div>
                    </li>
                    <li><strong>ç‰¹é»ï¼š</strong>é€™å€‹æ•¸å€¼æ˜¯<strong>ä¼°è¨ˆã€è¿‘ä¼¼</strong>çš„ï¼Œå¹«åŠ©æˆ‘å€‘ã€ŒçŒœæ¸¬ã€è·é›¢çµ‚é»é‚„æœ‰å¤šé </li>
                    <li><strong>ç´„æŸï¼š</strong>å¿…é ˆ<strong>å¯æ¥å—ï¼ˆadmissibleï¼‰</strong>ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½é«˜ä¼°å¯¦éš›è·é›¢</li>
                </ul>
                
                <div style="background: #e8f5e9; padding: 15px; margin-top: 15px; border-radius: 8px; border-left: 4px solid #4CAF50;">
                    <strong>ğŸ’¡ ç¯„ä¾‹ï¼š</strong>ç›®å‰ç¯€é»æ˜¯ (2,1)ï¼Œçµ‚é»æ˜¯ (9,9)
                    <br>h(2,1) = |2 - 9| + |1 - 9| = 7 + 8 = <strong>15</strong>
                    <br>é€™è¡¨ç¤ºæˆ‘å€‘ä¼°è¨ˆå¾ (2,1) åˆ° (9,9) è‡³å°‘éœ€è¦ 15 æ­¥
                </div>
            </div>

            <div class="step">
                <h4 style="color: #667eea; margin-bottom: 10px;">3. f(n) - ç¸½è©•ä¼°å€¼ï¼ˆç¯€é»å„ªå…ˆé †åºï¼‰</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>å«ç¾©ï¼š</strong>ç¯€é» n çš„<strong>ç¸½è©•ä¼°å€¼</strong>ï¼Œç”¨ä¾†æ±ºå®šæ¢ç´¢å„ªå…ˆé †åº</li>
                    <li><strong>è¨ˆç®—æ–¹å¼ï¼š</strong>
                        <div class="formula" style="margin: 10px 0;">
                            f(n) = g(n) + h(n)
                        </div>
                    </li>
                    <li><strong>ä½œç”¨ï¼š</strong>f(n) å€¼<strong>è¶Šå°</strong>ï¼Œç¯€é»å„ªå…ˆé †åº<strong>è¶Šé«˜</strong>ï¼Œè¶Šæœƒè¢«å„ªå…ˆæ¢ç´¢</li>
                    <li><strong>æ„ç¾©ï¼š</strong>f(n) ä»£è¡¨ã€Œå¾èµ·é»ç¶“éç¯€é» n æŠµé”çµ‚é»çš„ä¼°è¨ˆç¸½ä»£åƒ¹ã€</li>
                </ul>
                
                <div style="background: #e8f5e9; padding: 15px; margin-top: 15px; border-radius: 8px; border-left: 4px solid #4CAF50;">
                    <strong>ğŸ’¡ ç¯„ä¾‹ï¼š</strong>ç¯€é» (2,1) çš„è©•ä¼°
                    <br>g(2,1) = 3ï¼ˆå·²èµ° 3 æ­¥ï¼‰
                    <br>h(2,1) = 15ï¼ˆä¼°è¨ˆé‚„éœ€ 15 æ­¥ï¼‰
                    <br>f(2,1) = 3 + 15 = <strong>18</strong>
                    <br>é€™ä»£è¡¨æˆ‘å€‘ä¼°è¨ˆå¾èµ·é»ç¶“é (2,1) æŠµé”çµ‚é»ç¸½å…±éœ€è¦ 18 æ­¥
                </div>
            </div>

            <h3>ğŸ”„ ç¯€é»è©•ä¼°çš„å®Œæ•´æµç¨‹</h3>

            <div class="step">
                <span class="step-number">æ­¥é©Ÿ 1</span>
                <strong>åˆå§‹åŒ–èµ·é»ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>g(èµ·é») = 0ï¼ˆèµ·é»åˆ°è‡ªå·±çš„è·é›¢ç‚º 0ï¼‰</li>
                    <li>h(èµ·é») = æ›¼å“ˆé “è·é›¢(èµ·é», çµ‚é»)</li>
                    <li>f(èµ·é») = g(èµ·é») + h(èµ·é») = 0 + h(èµ·é»)</li>
                    <li>å°‡èµ·é»åŠ å…¥ <code>openSet</code></li>
                </ul>
            </div>

            <div class="step">
                <span class="step-number">æ­¥é©Ÿ 2</span>
                <strong>é¸æ“‡ä¸‹ä¸€å€‹è¦æ¢ç´¢çš„ç¯€é»ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>èµ°è¨ª <code>openSet</code> ä¸­çš„æ‰€æœ‰ç¯€é»</li>
                    <li>æ‰¾åˆ° <strong>f(n) å€¼æœ€å°</strong> çš„ç¯€é»</li>
                    <li>å¦‚æœå¤šå€‹ç¯€é»çš„ f(n) ç›¸åŒï¼Œé¸æ“‡ h(n) è¼ƒå°çš„ï¼ˆæ›´æ¥è¿‘çµ‚é»ï¼‰</li>
                    <li>é€™å€‹ç¯€é»æˆç‚º<strong>ç›®å‰ç¯€é»</strong></li>
                </ul>
                
                <div style="background: #fff3cd; padding: 15px; margin-top: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
                    <strong>ğŸ“ ç¯„ä¾‹æƒ…å¢ƒï¼š</strong>
                    <br>openSet ä¸­æœ‰ä¸‰å€‹ç¯€é»ï¼š
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>ç¯€é» Aï¼šf=12, g=5, h=7</li>
                        <li>ç¯€é» Bï¼šf=10, g=4, h=6 â† <strong>é¸é€™å€‹ï¼ˆf å€¼æœ€å°ï¼‰</strong></li>
                        <li>ç¯€é» Cï¼šf=12, g=6, h=6</li>
                    </ul>
                </div>
            </div>

            <div class="step">
                <span class="step-number">æ­¥é©Ÿ 3</span>
                <strong>è©•ä¼°ç›®å‰ç¯€é»çš„æ‰€æœ‰é„°å±…ï¼š</strong>
                <ul style="margin-left: 40px; margin-top: 10px;">
                    <li>å°æ–¼æ¯å€‹é„°å±…ç¯€é»ï¼ŒåŸ·è¡Œä»¥ä¸‹è¨ˆç®—ï¼š</li>
                </ul>
                
                <div style="background: #f5f5f5; padding: 20px; margin: 15px 0; border-radius: 8px; border: 2px solid #667eea;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">å°æ–¼é„°å±…ç¯€é» neighborï¼š</h4>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>3.1 è¨ˆç®— tentative_gï¼ˆæš«æ™‚ g å€¼ï¼‰ï¼š</strong>
                        <div class="formula" style="margin: 10px 0; font-size: 1.1em;">
                            tentative_g = g(å½“å‰èŠ‚ç‚¹) + ç§»åŠ¨ä»£ä»·
                        </div>
                        <p style="margin-left: 20px;">åœ¨ç¶²æ ¼åœ°åœ–ä¸­ï¼Œç§»å‹•ä»£åƒ¹é€šå¸¸ç‚º 1</p>
                    </div>

                    <div style="margin-bottom: 15px;">
                        <strong>3.2 æª¢æŸ¥æ˜¯å¦æ‰¾åˆ°æ›´å¥½çš„è·¯å¾‘ï¼š</strong>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>å¦‚æœ neighbor ä¸åœ¨ <code>openSet</code> ä¸­ï¼š
                                <ul style="margin-left: 20px;">
                                    <li>å°‡ neighbor åŠ å…¥ <code>openSet</code></li>
                                    <li>è¨­å®š g(neighbor) = tentative_g</li>
                                    <li>è¨ˆç®— h(neighbor) = æ›¼å“ˆé “è·é›¢(neighbor, çµ‚é»)</li>
                                    <li>è¨ˆç®— f(neighbor) = g(neighbor) + h(neighbor)</li>
                                    <li>è¨­å®š çˆ¶ç¯€é»(neighbor) = ç›®å‰ç¯€é»</li>
                                </ul>
                            </li>
                            <li>å¦‚æœ neighbor å·²åœ¨ <code>openSet</code> ä¸­ï¼š
                                <ul style="margin-left: 20px;">
                                    <li>æ¯”è¼ƒ tentative_g å’Œ g(neighbor)</li>
                                    <li>å¦‚æœ tentative_g < g(neighbor)ï¼ˆæ‰¾åˆ°æ›´å¥½çš„è·¯å¾‘ï¼‰ï¼š
                                        <ul style="margin-left: 20px;">
                                            <li>æ›´æ–° g(neighbor) = tentative_g</li>
                                            <li>é‡æ–°è¨ˆç®— f(neighbor) = g(neighbor) + h(neighbor)</li>
                                            <li>æ›´æ–° çˆ¶ç¯€é»(neighbor) = ç›®å‰ç¯€é»</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3>ğŸ“ˆ å¯¦éš›è¨ˆç®—ç¯„ä¾‹</h3>
            
            <div style="background: #e3f2fd; padding: 20px; margin: 20px 0; border-radius: 8px; border: 2px solid #2196F3;">
                <h4 style="color: #1976d2; margin-bottom: 15px;">æƒ…å¢ƒï¼š5x5 ç¶²æ ¼åœ°åœ–</h4>
                <ul style="line-height: 2;">
                    <li><strong>èµ·é»ï¼š</strong>(0, 0)</li>
                    <li><strong>çµ‚é»ï¼š</strong>(4, 4)</li>
                    <li><strong>ç›®å‰ç¯€é»ï¼š</strong>(2, 1)ï¼ˆå‡è¨­å·²å¾èµ·é»èµ°åˆ°é€™è£¡ï¼‰</li>
                </ul>

                <div style="margin-top: 20px;">
                    <strong>ç›®å‰ç¯€é» (2, 1) çš„è¨ˆç®—ï¼š</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>g(2,1) = 3ï¼ˆå‡è¨­è·¯å¾‘æ˜¯ (0,0)â†’(1,0)â†’(2,0)â†’(2,1)ï¼‰</li>
                        <li>h(2,1) = |2-4| + |1-4| = 2 + 3 = 5</li>
                        <li>f(2,1) = 3 + 5 = 8</li>
                    </ul>
                </div>

                <div style="margin-top: 20px;">
                    <strong>è©•ä¼°é„°å±…ç¯€é» (2, 2)ï¼š</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>tentative_g = g(2,1) + 1 = 3 + 1 = 4</li>
                        <li>h(2,2) = |2-4| + |2-4| = 2 + 2 = 4</li>
                        <li>f(2,2) = 4 + 4 = 8</li>
                        <li>å¦‚æœ (2,2) ä¸åœ¨ openSet ä¸­ï¼Œå°‡å…¶åŠ å…¥ä¸¦è¨­å®šçˆ¶ç¯€é»ç‚º (2,1)</li>
                    </ul>
                </div>

                <div style="margin-top: 20px;">
                    <strong>è©•ä¼°é„°å±…ç¯€é» (3, 1)ï¼š</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>tentative_g = g(2,1) + 1 = 3 + 1 = 4</li>
                        <li>h(3,1) = |3-4| + |1-4| = 1 + 3 = 4</li>
                        <li>f(3,1) = 4 + 4 = 8</li>
                        <li>å¦‚æœ (3,1) å·²åœ¨ openSet ä¸­ï¼Œä¸”ä¹‹å‰çš„ g(3,1) = 5ï¼š
                            <ul style="margin-left: 20px;">
                                <li>å› ç‚º tentative_g(4) < g(3,1)(5)ï¼Œæ‰¾åˆ°æ›´å¥½çš„è·¯å¾‘</li>
                                <li>æ›´æ–° g(3,1) = 4</li>
                                <li>æ›´æ–° f(3,1) = 4 + 4 = 8</li>
                                <li>æ›´æ–°çˆ¶ç¯€é»(3,1) = (2,1)</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

            <h3>ğŸ¯ é—œéµç†è§£é‡é»</h3>
            
            <div class="tip">
                <strong>1. g(n) æ˜¯ç´¯ç©çš„å¯¦éš›ä»£åƒ¹ï¼š</strong>
                <p style="margin-left: 20px; margin-top: 10px;">g(n) ç´€éŒ„çš„æ˜¯å¾èµ·é»åˆ°ç¯€é» n çš„<strong>å¯¦éš›èµ°éçš„è·¯å¾‘</strong>ã€‚æ¯æ¬¡ç§»å‹•ï¼Œg å€¼éƒ½æœƒå¢åŠ ç§»å‹•ä»£åƒ¹ã€‚</p>
            </div>

            <div class="tip">
                <strong>2. h(n) æ˜¯å•Ÿç™¼å¼ä¼°è¨ˆï¼š</strong>
                <p style="margin-left: 20px; margin-top: 10px;">h(n) å¹«åŠ©æˆ‘å€‘ã€ŒçŒœæ¸¬ã€è·é›¢çµ‚é»é‚„æœ‰å¤šé ã€‚å®ƒä¸èƒ½é«˜ä¼°å¯¦éš›è·é›¢ï¼Œä½†å¯ä»¥ä½ä¼°ã€‚æ›¼å“ˆé “è·é›¢åœ¨ç¶²æ ¼åœ°åœ–ä¸­æ˜¯ä¸€å€‹å¾ˆå¥½çš„å¯æ¥å—å•Ÿç™¼å¼å‡½æ•¸ã€‚</p>
            </div>

            <div class="tip">
                <strong>3. f(n) æ±ºå®šæ¢ç´¢é †åºï¼š</strong>
                <p style="margin-left: 20px; margin-top: 10px;">f(n) = g(n) + h(n) ä»£è¡¨ã€Œå¾èµ·é»ç¶“éç¯€é» n æŠµé”çµ‚é»çš„ä¼°è¨ˆç¸½ä»£åƒ¹ã€ã€‚æ¼”ç®—æ³•æœƒå„ªå…ˆæ¢ç´¢ f å€¼æœ€å°çš„ç¯€é»ï¼Œå¦‚æ­¤å¯ä»¥æ›´å¿«æ‰¾åˆ°æœ€å„ªè·¯å¾‘ã€‚</p>
            </div>

            <div class="warning">
                <strong>4. è·¯å¾‘æ›´æ–°æ©Ÿåˆ¶ï¼š</strong>
                <p style="margin-left: 20px; margin-top: 10px;">ç•¶ç™¼ç¾å¾ç›®å‰ç¯€é»åˆ°æŸå€‹é„°å±…çš„è·¯å¾‘æ¯”å…ˆå‰ç´€éŒ„çš„æ›´çŸ­æ™‚ï¼ˆtentative_g < g(neighbor)ï¼‰ï¼Œå¿…é ˆæ›´æ–°è©²é„°å±…çš„ g å€¼ã€f å€¼èˆ‡çˆ¶ç¯€é»ï¼Œæ‰èƒ½ç¢ºä¿æ¼”ç®—æ³•æ‰¾åˆ°çœŸæ­£çš„æœ€çŸ­è·¯å¾‘ã€‚</p>
            </div>

            <div style="background: #f3e5f5; padding: 20px; margin-top: 20px; border-radius: 8px; border-left: 4px solid #9c27b0;">
                <h4 style="color: #7b1fa2; margin-bottom: 10px;">ğŸ’­ ç‚ºä»€éº¼è¦é€™æ¨£è¨­è¨ˆï¼Ÿ</h4>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>g(n)ï¼š</strong>ä¿è­‰æˆ‘å€‘æ‰¾åˆ°çš„æ˜¯å¯¦éš›æœ€çŸ­è·¯å¾‘ï¼ˆä¾†è‡ª Dijkstra æ¼”ç®—æ³•çš„æ¦‚å¿µï¼‰</li>
                    <li><strong>h(n)ï¼š</strong>å¼•å°æœå°‹æ–¹å‘ï¼Œé¿å…ç›²ç›®æ¢ç´¢ï¼ˆä¾†è‡ªè²ªå¿ƒæ¼”ç®—æ³•çš„æ¦‚å¿µï¼‰</li>
                    <li><strong>f(n)ï¼š</strong>å¹³è¡¡å…©è€…ï¼Œæ—¢ä¿è­‰æœ€å„ªæ€§åˆæå‡æ•ˆç‡</li>
                </ul>
            </div>
        </div>

        <!-- 4. å¯è§†åŒ–æ¼”ç¤º -->
        <div class="section">
            <h2>4. è¦–è¦ºåŒ–ç¤ºç¯„</h2>
            <p>ä¸‹é¢æ˜¯ä¸€å€‹ 10x10 çš„ç¶²æ ¼åœ°åœ–ï¼Œé»æ“ŠæŒ‰éˆ•å³å¯æŸ¥çœ‹ A* ç®—æ³•çš„åŸ·è¡Œéç¨‹ï¼š</p>
            
            <div class="tip" style="margin-bottom: 20px;">
                <strong>ğŸ“– å¦‚ä½•é–±è®€ç¶²æ ¼ï¼š</strong>
                <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                    <li>æ¯å€‹æ ¼å­æœƒé¡¯ç¤º<strong>åœ–ç¤º</strong>ã€<strong>åº§æ¨™ (x, y)</strong>ï¼Œä»¥åŠåœ¨éœ€è¦æ™‚é¡¯ç¤º <strong>f/g/h å€¼</strong></li>
                    <li>åº§æ¨™æ ¼å¼ï¼š<code>(x, y)</code>ï¼Œx æ˜¯æ¬„ä½ç´¢å¼•ï¼ˆç”±å·¦åˆ°å³ï¼‰ï¼Œy æ˜¯åˆ—ç´¢å¼•ï¼ˆç”±ä¸Šåˆ°ä¸‹ï¼‰</li>
                    <li>ä¸åŒé¡è‰²èˆ‡åœ–ç¤ºä»£è¡¨ä¸åŒçš„ç¯€é»ç‹€æ…‹</li>
                    <li>æ¼”ç®—æ³•æœƒé€æ­¥æ¢ç´¢ç¯€é»ï¼Œç¶ è‰²ä»£è¡¨å¾…æ¢ç´¢ï¼Œç²‰è‰²ä»£è¡¨å·²æ¢ç´¢ï¼Œé»ƒè‰²ä»£è¡¨ç›®å‰æ­£åœ¨è™•ç†çš„ç¯€é»</li>
                </ul>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color start">ğŸš©</div>
                    <span><strong>èµ·é» (Start)</strong></span>
                </div>
                <div class="legend-item">
                    <div class="legend-color end">ğŸ¯</div>
                    <span><strong>çµ‚é» (End)</strong></span>
                </div>
                <div class="legend-item">
                    <div class="legend-color wall">â¬›</div>
                    <span><strong>éšœç¤™ç‰© (Wall)</strong></span>
                </div>
                <div class="legend-item">
                    <div class="legend-color path">â­</div>
                    <span><strong>æœ€çµ‚è·¯å¾‘ (Path)</strong></span>
                </div>
                <div class="legend-item">
                    <div class="legend-color open">â—‹</div>
                    <span><strong>é–‹æ”¾åˆ—è¡¨ (Open Set)</strong> - å¾…æ¢ç´¢</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color closed">âœ•</div>
                    <span><strong>é—œé–‰åˆ—è¡¨ (Closed Set)</strong> - å·²æ¢ç´¢</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color current">ğŸ“</div>
                    <span><strong>ç›®å‰ç¯€é» (Current)</strong> - æ­£åœ¨è™•ç†</span>
                </div>
            </div>

            <!-- æƒ…å¢ƒåˆ‡æ¢ Tab -->
            <div class="scenario-tabs">
                <div class="scenario-tab active" onclick="setScenario('near', this)">æƒ…å¢ƒä¸€ï¼šè¿‘è·é›¢ç›®æ¨™</div>
                <div class="scenario-tab" onclick="setScenario('corridor', this)">æƒ…å¢ƒäºŒï¼šç‹¹é•·èµ°å»Š</div>
                <div class="scenario-tab" onclick="setScenario('heuristicGood', this)">æƒ…å¢ƒä¸‰ï¼šè‰¯å¥½å•Ÿç™¼ (Manhattan)</div>
                <div class="scenario-tab" onclick="setScenario('heuristicBad', this)">æƒ…å¢ƒä¸‰ï¼šç„¡å•Ÿç™¼ (h=0)</div>
            </div>

            <div class="button-group">
                <button onclick="startVisualization()">é–‹å§‹ç¤ºç¯„</button>
                <button onclick="resetGrid()">é‡ç½®</button>
                <button onclick="stepByStep()">å–®æ­¥åŸ·è¡Œ</button>
            </div>

            <div id="grid" class="grid-container"></div>
                <div id="info" style="text-align: center; margin-top: 25px; padding: 15px; background: #e3f2fd; border-radius: 8px; font-size: 1.1em; color: #1976d2; font-weight: 500; border: 2px solid #90caf9;"></div>
            <div id="stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                <div style="padding: 15px; background: #f5f5f5; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">é–‹æ”¾åˆ—è¡¨ç¯€é»æ•¸</div>
                    <div id="openCount" style="font-size: 1.5em; font-weight: bold; color: #4CAF50;">0</div>
                </div>
                <div style="padding: 15px; background: #f5f5f5; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">é—œé–‰åˆ—è¡¨ç¯€é»æ•¸</div>
                    <div id="closedCount" style="font-size: 1.5em; font-weight: bold; color: #f44336;">0</div>
                </div>
                <div style="padding: 15px; background: #f5f5f5; border-radius: 8px; text-align: center;">
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">è·¯å¾‘é•·åº¦</div>
                    <div id="pathLength" style="font-size: 1.5em; font-weight: bold; color: #2196F3;">-</div>
                </div>
            </div>
        </div>

        <!-- 5. å¯å‘å¼å‡½æ•° -->
        <div class="section">
            <h2>5. å¸¸ç”¨å•Ÿç™¼å¼å‡½æ•¸</h2>
            
            <h3>5.1 æ›¼å“ˆé “è·é›¢ï¼ˆManhattan Distanceï¼‰</h3>
            <p>é©ç”¨æ–¼åªèƒ½ä¸Šä¸‹å·¦å³ç§»å‹•çš„ç¶²æ ¼åœ°åœ–ï¼š</p>
            <div class="formula">
                h(n) = |xâ‚ - xâ‚‚| + |yâ‚ - yâ‚‚|
            </div>
            <pre><code>function manhattanDistance(node, goal) {
    return Math.abs(node.x - goal.x) + Math.abs(node.y - goal.y);
}</code></pre>

            <h3>5.2 æ­å¹¾é‡Œå¾—è·é›¢ï¼ˆEuclidean Distanceï¼‰</h3>
            <p>é©ç”¨æ–¼å¯ä»¥æ–œå‘ç§»å‹•çš„åœ°åœ–ï¼š</p>
            <div class="formula">
                h(n) = âˆš[(xâ‚ - xâ‚‚)Â² + (yâ‚ - yâ‚‚)Â²]
            </div>
            <pre><code>function euclideanDistance(node, goal) {
    const dx = node.x - goal.x;
    const dy = node.y - goal.y;
    return Math.sqrt(dx * dx + dy * dy);
}</code></pre>

            <h3>5.3 åˆ‡æ¯”é›ªå¤«è·é›¢ï¼ˆChebyshev Distanceï¼‰</h3>
            <p>é©ç”¨æ–¼å¯ä»¥å…«æ–¹å‘ç§»å‹•çš„åœ°åœ–ï¼š</p>
            <div class="formula">
                h(n) = max(|xâ‚ - xâ‚‚|, |yâ‚ - yâ‚‚|)
            </div>
            <pre><code>function chebyshevDistance(node, goal) {
    return Math.max(
        Math.abs(node.x - goal.x),
        Math.abs(node.y - goal.y)
    );
}</code></pre>
        </div>

        <!-- 6. ä¼ªä»£ç  -->
        <div class="section">
            <h2>6. å®Œæ•´å½ç¨‹å¼ç¢¼</h2>
            <pre><code>function AStar(start, goal):
    // åˆå§‹åŒ–
    openSet = [start]
    closedSet = []
    gScore = {start: 0}
    fScore = {start: heuristic(start, goal)}
    cameFrom = {}
    
    while openSet is not empty:
        // é€‰æ‹© f(n) æœ€å°çš„èŠ‚ç‚¹
        current = node in openSet with lowest fScore
        
        if current == goal:
            return reconstructPath(cameFrom, current)
        
        openSet.remove(current)
        closedSet.add(current)
        
        // æ¢ç´¢é‚»å±…
        for each neighbor of current:
            if neighbor in closedSet:
                continue
            
            if neighbor is obstacle:
                continue
            
            // è®¡ç®—æ–°çš„ g å€¼
            tentative_gScore = gScore[current] + distance(current, neighbor)
            
            if neighbor not in openSet:
                openSet.add(neighbor)
            else if tentative_gScore >= gScore[neighbor]:
                continue  // è¿™ä¸æ˜¯æ›´å¥½çš„è·¯å¾„
            
            // æ‰¾åˆ°æ›´å¥½çš„è·¯å¾„ï¼Œæ›´æ–°
            cameFrom[neighbor] = current
            gScore[neighbor] = tentative_gScore
            fScore[neighbor] = gScore[neighbor] + heuristic(neighbor, goal)
    
    return null  // æ²¡æœ‰æ‰¾åˆ°è·¯å¾„

function reconstructPath(cameFrom, current):
    path = [current]
    while current in cameFrom:
        current = cameFrom[current]
        path.prepend(current)
    return path</code></pre>
        </div>

        <!-- 7. æ—¶é—´å¤æ‚åº¦ -->
        <div class="section">
            <h2>7. ç®—æ³•è¤‡é›œåº¦</h2>
            <table class="comparison-table">
                <tr>
                    <th>è¤‡é›œåº¦é¡å‹</th>
                    <th>æ•¸å€¼</th>
                    <th>èªªæ˜</th>
                </tr>
                <tr>
                    <td><strong>æ™‚é–“è¤‡é›œåº¦</strong></td>
                    <td>O(b^d)</td>
                    <td>b ç‚ºåˆ†æ”¯å› å­ï¼Œd ç‚ºè§£çš„æ·±åº¦ã€‚æœ€å£æƒ…æ³ä¸‹éœ€è¦æ¢ç´¢æ‰€æœ‰ç¯€é»</td>
                </tr>
                <tr>
                    <td><strong>ç©ºé–“è¤‡é›œåº¦</strong></td>
                    <td>O(b^d)</td>
                    <td>éœ€è¦å„²å­˜é–‹æ”¾åˆ—è¡¨èˆ‡é—œé–‰åˆ—è¡¨ä¸­çš„æ‰€æœ‰ç¯€é»</td>
                </tr>
                <tr>
                    <td><strong>æœ€å„ªæ€§</strong></td>
                    <td>âœ“ ä¿è­‰</td>
                    <td>ç•¶å•Ÿç™¼å¼å‡½æ•¸å¯æ¥å—æ™‚ï¼Œå¯ä¿è­‰æ‰¾åˆ°æœ€å„ªè§£</td>
                </tr>
                <tr>
                    <td><strong>å®Œå‚™æ€§</strong></td>
                    <td>âœ“ ä¿è­‰</td>
                    <td>å¦‚æœå­˜åœ¨è§£ï¼Œä¸€å®šèƒ½æ‰¾åˆ°</td>
                </tr>
            </table>
        </div>

        <!-- 8. ä¸å…¶ä»–ç®—æ³•æ¯”è¾ƒ -->
        <div class="section">
            <h2>8. èˆ‡å…¶ä»–ç®—æ³•æ¯”è¼ƒ</h2>
            <table class="comparison-table">
                <tr>
                    <th>ç®—æ³•</th>
                    <th>å„ªé»</th>
                    <th>ç¼ºé»</th>
                    <th>é©ç”¨æƒ…å¢ƒ</th>
                </tr>
                <tr>
                    <td><strong>A*</strong></td>
                    <td>æœ€å„ªè§£ã€æ•ˆç‡é«˜ã€ä½¿ç”¨å•Ÿç™¼å¼</td>
                    <td>éœ€è¦è‰¯å¥½çš„å•Ÿç™¼å¼å‡½æ•¸</td>
                    <td>è·¯å¾‘è¦åŠƒã€éŠæˆ² AI</td>
                </tr>
                <tr>
                    <td><strong>Dijkstra</strong></td>
                    <td>ä¿è­‰æœ€å„ªè§£ã€ç„¡éœ€å•Ÿç™¼å¼</td>
                    <td>é€Ÿåº¦è¼ƒæ…¢ã€å¹¾ä¹æ¢ç´¢æ‰€æœ‰æ–¹å‘</td>
                    <td>å–®æºæœ€çŸ­è·¯å¾‘</td>
                </tr>
                <tr>
                    <td><strong>BFS</strong></td>
                    <td>ç°¡å–®ã€å¯ä¿è­‰æœ€çŸ­è·¯å¾‘ï¼ˆé‚Šæ¬Šç‚º 1ï¼‰</td>
                    <td>æ•ˆç‡è¼ƒä½ã€ä¸æ”¯æ´æ¬Šé‡</td>
                    <td>ç„¡æ¬Šåœ–æœ€çŸ­è·¯å¾‘</td>
                </tr>
                <tr>
                    <td><strong>è²ªå¿ƒæœ€ä½³å„ªå…ˆ</strong></td>
                    <td>é€Ÿåº¦å¿«</td>
                    <td>ä¸ä¿è­‰æœ€å„ªè§£</td>
                    <td>åªéœ€è¿‘ä¼¼è§£çš„æƒ…å¢ƒ</td>
                </tr>
            </table>
        </div>

        <!-- 9. å®é™…åº”ç”¨ -->
        <div class="section">
            <h2>9. å¯¦éš›æ‡‰ç”¨æƒ…å¢ƒ</h2>
            <ul style="margin-left: 20px; line-height: 2;">
                <li>ğŸ® <strong>éŠæˆ²é–‹ç™¼ï¼š</strong>NPC å°‹è·¯ã€å–®ä½ç§»å‹•</li>
                <li>ğŸ—ºï¸ <strong>åœ°åœ–å°è¦½ï¼š</strong>GPS è·¯å¾‘è¦åŠƒã€è·¯ç·šæœ€ä½³åŒ–</li>
                <li>ğŸ¤– <strong>æ©Ÿå™¨äººå°èˆªï¼š</strong>ç§»å‹•æ©Ÿå™¨äººè·¯å¾‘è¦åŠƒ</li>
                <li>ğŸ“¦ <strong>ç‰©æµæœ€ä½³åŒ–ï¼š</strong>å€‰åº«æ€è²¨è·¯å¾‘ã€é…é€è·¯ç·š</li>
                <li>ğŸŒ <strong>ç¶²è·¯è·¯ç”±ï¼š</strong>è³‡æ–™å°åŒ…è½‰é€è·¯å¾‘é¸æ“‡</li>
                <li>ğŸ§© <strong>æ‹¼åœ–éŠæˆ²ï¼š</strong>æ±‚è§£æœ€ä½³ç§»å‹•åºåˆ—</li>
            </ul>
        </div>

        <!-- 10. ä¼˜åŒ–æŠ€å·§ -->
        <div class="section">
            <h2>10. å„ªåŒ–æŠ€å·§</h2>
            <h3>10.1 ä½¿ç”¨å„ªå…ˆä½‡åˆ—</h3>
            <p>ä½¿ç”¨äºŒå…ƒå †æˆ–è²»æ³¢é‚£å¥‘å †å¯¦ä½œå„ªå…ˆä½‡åˆ—ï¼Œå¯ä»¥å¿«é€Ÿå–å¾— f(n) æœ€å°çš„ç¯€é»ã€‚</p>

            <h3>10.2 é›™å‘æœå°‹</h3>
            <p>åŒæ™‚å¾èµ·é»èˆ‡çµ‚é»é–‹å§‹æœå°‹ï¼Œç•¶å…©é‚Šç›¸é‡æ™‚åœæ­¢ï¼Œå¯ä»¥å¤§å¹…æ¸›å°‘æœå°‹ç©ºé–“ã€‚</p>

            <h3>10.3 IDA*ï¼ˆè¿­ä»£åŠ æ·± A*ï¼‰</h3>
            <p>çµåˆè¿­ä»£åŠ æ·±æœå°‹èˆ‡ A* ç®—æ³•ï¼Œè¨˜æ†¶é«”å ç”¨è¼ƒå°ï¼Œé©åˆè¨˜æ†¶é«”å—é™çš„æƒ…å¢ƒã€‚</p>

            <h3>10.4 JPSï¼ˆJump Point Searchï¼‰</h3>
            <p>å°ˆé–€é‡å°ç¶²æ ¼åœ°åœ–çš„å„ªåŒ–æŠ€å·§ï¼Œå¯ä»¥è·³éå¤§é‡ä¸å¿…è¦çš„ç¯€é»ã€‚</p>
        </div>
    </div>

    <script>
        // ç¶²æ ¼å¤§å°
        const ROWS = 10;
        const COLS = 10;
        
        // ç¯€é»ç‹€æ…‹
        const EMPTY = 0;
        const WALL = 1;
        const START = 2;
        const END = 3;
        const PATH = 4;
        const OPEN = 5;
        const CLOSED = 6;
        const CURRENT = 7;

        let grid = [];
        let startNode = {x: 0, y: 0};
        let endNode = {x: 9, y: 9};
        let visualizationStep = 0;
        let visualizationData = [];
        let isRunning = false;
        let nodeValues = {}; // å­˜æ”¾æ¯å€‹ç¯€é»çš„ f, g, h å€¼
        let wallsConfig = []; // ç›®å‰æƒ…å¢ƒçš„ç‰†å£é…ç½®
        let heuristicMode = 'manhattan'; // 'manhattan' æˆ– 'none'
        let currentScenario = 'near';

        // åˆå§‹åŒ–ç¶²æ ¼
        function initGrid() {
            grid = [];
            for (let i = 0; i < ROWS; i++) {
                grid[i] = [];
                for (let j = 0; j < COLS; j++) {
                    grid[i][j] = EMPTY;
                }
            }
            
            // è®¾ç½®èµ·ç‚¹å’Œç»ˆç‚¹
            grid[startNode.y][startNode.x] = START;
            grid[endNode.y][endNode.x] = END;
            
            // æ ¹æ®å½“å‰æƒ…å¢ƒçš„å¢™é…ç½®æ·»åŠ éšœç¢ç‰©
            if (Array.isArray(wallsConfig)) {
                wallsConfig.forEach(([x, y]) => {
                    if (grid[y] && grid[y][x] === EMPTY) {
                        grid[y][x] = WALL;
                    }
                });
            }
            
            renderGrid();
        }

        // æ¸²æŸ“ç¶²æ ¼
        function renderGrid() {
            const gridDiv = document.getElementById('grid');
            gridDiv.innerHTML = '';
            
            for (let i = 0; i < ROWS; i++) {
                for (let j = 0; j < COLS; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.id = `cell-${i}-${j}`;
                    
                    // å»ºç«‹åœ–ç¤ºå…ƒç´ 
                    const icon = document.createElement('div');
                    icon.className = 'icon';
                    
                    // å»ºç«‹åº§æ¨™å…ƒç´ 
                    const coords = document.createElement('div');
                    coords.className = 'coords';
                    coords.textContent = `(${j},${i})`;
                    
                    // å»ºç«‹æ•¸å€¼é¡¯ç¤ºå…ƒç´ 
                    const values = document.createElement('div');
                    values.className = 'values';
                    
                    const state = grid[i][j];
                    const nodeKey = `${j},${i}`;
                    const valuesData = nodeValues[nodeKey];
                    
                    if (state === START) {
                        cell.classList.add('start');
                        icon.textContent = 'ğŸš©';
                    } else if (state === END) {
                        cell.classList.add('end');
                        icon.textContent = 'ğŸ¯';
                    } else if (state === WALL) {
                        cell.classList.add('wall');
                        icon.textContent = 'â¬›';
                    } else if (state === PATH) {
                        cell.classList.add('path');
                        icon.textContent = 'â­';
                    } else if (state === OPEN) {
                        cell.classList.add('open');
                        icon.textContent = 'â—‹';
                    } else if (state === CLOSED) {
                        cell.classList.add('closed');
                        icon.textContent = 'âœ•';
                    } else if (state === CURRENT) {
                        cell.classList.add('current');
                        icon.textContent = 'ğŸ“';
                    } else {
                        cell.classList.add('empty');
                        // ç©ºå•å…ƒæ ¼ä¸æ˜¾ç¤ºå›¾æ ‡ï¼Œåªæ˜¾ç¤ºåæ ‡
                    }
                    
                    // é¡¯ç¤º f, g, h å€¼ï¼ˆå¦‚æœæœ‰ï¼‰
                    if (valuesData && (state === OPEN || state === CLOSED || state === CURRENT || state === PATH)) {
                        values.innerHTML = `
                            <div class="f-value">f=${valuesData.f}</div>
                            <div class="g-value">g=${valuesData.g}</div>
                            <div class="h-value">h=${valuesData.h}</div>
                        `;
                    }
                    
                    cell.appendChild(icon);
                    cell.appendChild(coords);
                    if (values.innerHTML) {
                        cell.appendChild(values);
                    }
                    gridDiv.appendChild(cell);
                }
            }
        }

        // å•Ÿç™¼å¼å‡½æ•¸ï¼ˆæ”¯æ´å¤šç¨®æ¨¡å¼ï¼‰
        function heuristic(node, goal) {
            if (heuristicMode === 'none') {
                // å•Ÿç™¼å¼ç‚º 0ï¼Œç›¸ç•¶æ–¼ Dijkstraï¼šä¸ã€Œæ‹‰å‘çµ‚é»ã€ï¼Œæœå°‹æœƒè¼ƒå¹³å‡å‘å››å‘¨æ“´æ•£
                return 0;
            }
            // é è¨­ï¼šæ›¼å“ˆé “è·é›¢ï¼Œé©åˆåªèƒ½ä¸Šä¸‹å·¦å³ç§»å‹•çš„ç¶²æ ¼
            return Math.abs(node.x - goal.x) + Math.abs(node.y - goal.y);
        }

        // å„ç¨®æƒ…å¢ƒçš„è¨­å®š
        const scenarios = {
            // æƒ…å¢ƒä¸€ï¼šè¿‘è·é›¢ç›®æ¨™ï¼Œåªæœƒè©•ä¼°ä¸€å°å¡Šå€åŸŸ
            near: {
                heuristicMode: 'manhattan',
                start: { x: 1, y: 1 },
                end:   { x: 3, y: 2 },
                walls: []
            },

            // æƒ…å¢ƒäºŒï¼šç‹¹é•·èµ°å»Šï¼Œåªæœƒæ²¿è‘—é€šé“è©•ä¼°
            corridor: {
                heuristicMode: 'manhattan',
                start: { x: 0, y: 5 },
                end:   { x: 9, y: 5 },
                walls: (function () {
                    const arr = [];
                    for (let x = 0; x < COLS; x++) {
                        arr.push([x, 4]); // ä¸Šæ’å¢™
                        arr.push([x, 6]); // ä¸‹æ’å¢™
                    }
                    return arr;
                })()
            },

            // æƒ…å¢ƒä¸‰ï¼ˆè‰¯å¥½å•Ÿç™¼ï¼‰ï¼šè¼ƒè¤‡é›œåœ°åœ– + æ›¼å“ˆé “è·é›¢
            heuristicGood: {
                heuristicMode: 'manhattan',
                start: { x: 0, y: 0 },
                end:   { x: 9, y: 9 },
                walls: [
                    [2, 2], [2, 3], [2, 4],
                    [5, 5], [5, 6], [5, 7],
                    [7, 2], [7, 3], [7, 4], [7, 5],
                    [3, 7], [4, 7], [5, 7]
                ]
            },

            // æƒ…å¢ƒä¸‰ï¼ˆç„¡å•Ÿç™¼ï¼‰ï¼šåŒä¸€å¼µåœ– + h=0
            heuristicBad: {
                heuristicMode: 'none',
                start: { x: 0, y: 0 },
                end:   { x: 9, y: 9 },
                walls: [
                    [2, 2], [2, 3], [2, 4],
                    [5, 5], [5, 6], [5, 7],
                    [7, 2], [7, 3], [7, 4], [7, 5],
                    [3, 7], [4, 7], [5, 7]
                ]
            }
        };

        // å¥—ç”¨æŒ‡å®šæƒ…å¢ƒçš„è¨­å®š
        function applyScenario(name) {
            const cfg = scenarios[name];
            if (!cfg) {
                return;
            }

            currentScenario = name;
            heuristicMode = cfg.heuristicMode;
            startNode = { ...cfg.start };
            endNode = { ...cfg.end };
            wallsConfig = cfg.walls.map(([x, y]) => [x, y]);

            nodeValues = {};
            initGrid();
            updateStats(0, 0, null);

            const info = document.getElementById('info');
            if (!info) {
                return;
            }
            if (name === 'near') {
                info.textContent = 'æƒ…å¢ƒä¸€ï¼šèµ·é»èˆ‡çµ‚é»å¾ˆè¿‘ï¼Œåªæœƒè©•ä¼°é™„è¿‘å°‘é‡ç¯€é»ã€‚';
            } else if (name === 'corridor') {
                info.textContent = 'æƒ…å¢ƒäºŒï¼šç‹¹é•·èµ°å»Šï¼Œç¯€é»è©•ä¼°é›†ä¸­åœ¨é€šé“ä¸Šã€‚';
            } else if (name === 'heuristicGood') {
                info.textContent = 'æƒ…å¢ƒä¸‰ï¼ˆè‰¯å¥½å•Ÿç™¼ï¼‰ï¼šä½¿ç”¨æ›¼å“ˆé “è·é›¢ï¼Œè©•ä¼°å€åŸŸæ›´è²¼è¿‘èµ·é» â†’ çµ‚é»æ–¹å‘ã€‚';
            } else if (name === 'heuristicBad') {
                info.textContent = 'æƒ…å¢ƒä¸‰ï¼ˆç„¡å•Ÿç™¼ï¼‰ï¼šh=0ï¼Œç›¸ç•¶æ–¼ Dijkstraï¼Œæœƒè©•ä¼°æ›´å¤šç¯€é»å‘å››å‘¨æ“´æ•£ã€‚';
            }
        }

        // Tab ç‚¹å‡»ï¼šæ›´æ–°æ ·å¼å¹¶åˆ‡æ¢æƒ…å¢ƒ
        function setScenario(name, el) {
            const tabs = document.querySelectorAll('.scenario-tab');
            tabs.forEach(t => t.classList.remove('active'));
            if (el) {
                el.classList.add('active');
            }

            // åœæ­¢å½“å‰åŠ¨ç”»å¹¶æ¸…ç©ºæ­¥éª¤
            isRunning = false;
            visualizationStep = 0;
            visualizationData = [];

            applyScenario(name);
        }

        // A* ç®—æ³•å¯¦ä½œï¼ˆç”¨æ–¼ç”¢ç”Ÿè¦–è¦ºåŒ–è³‡æ–™ï¼‰
        function aStar() {
            const openSet = [{x: startNode.x, y: startNode.y, g: 0, h: heuristic(startNode, endNode), f: heuristic(startNode, endNode)}];
            const closedSet = new Set();
            const cameFrom = {};
            const gScore = {};
            const fScore = {};
            
            const key = (x, y) => `${x},${y}`;
            gScore[key(startNode.x, startNode.y)] = 0;
            fScore[key(startNode.x, startNode.y)] = heuristic(startNode, endNode);
            
            const steps = [];
            
            while (openSet.length > 0) {
                // é€‰æ‹© f å€¼æœ€å°çš„èŠ‚ç‚¹
                openSet.sort((a, b) => a.f - b.f);
                const current = openSet.shift();
                const currentKey = key(current.x, current.y);
                
                // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ç»ˆç‚¹
                if (current.x === endNode.x && current.y === endNode.y) {
                    // é‡æ„è·¯å¾„
                    const path = [];
                    let node = currentKey;
                    while (node) {
                        const [x, y] = node.split(',').map(Number);
                        path.unshift({x, y});
                        node = cameFrom[node];
                    }
                    // è®°å½•å½“å‰æ­¥éª¤ï¼ˆåœ¨åŠ å…¥closedSetä¹‹å‰ï¼‰
                    const currentValues = {
                        f: fScore[currentKey],
                        g: gScore[currentKey],
                        h: fScore[currentKey] - gScore[currentKey]
                    };
                    steps.push({
                        type: 'current',
                        node: {x: current.x, y: current.y, ...currentValues},
                        openSet: openSet.map(n => {
                            const nKey = key(n.x, n.y);
                            return {
                                x: n.x,
                                y: n.y,
                                f: fScore[nKey],
                                g: gScore[nKey],
                                h: fScore[nKey] - gScore[nKey]
                            };
                        }),
                        closedSet: Array.from(closedSet).map(k => {
                            const [x, y] = k.split(',').map(Number);
                            return {
                                x, y,
                                f: fScore[k],
                                g: gScore[k],
                                h: fScore[k] - gScore[k]
                            };
                        })
                    });
                    steps.push({type: 'path', path, closedSet: Array.from(closedSet).concat([currentKey]).map(k => {
                        const [x, y] = k.split(',').map(Number);
                        return {x, y};
                    })});
                    return steps;
                }
                
                // è®°å½•å½“å‰æ­¥éª¤ï¼ˆåœ¨åŠ å…¥closedSetä¹‹å‰ï¼‰
                const currentValues = {
                    f: fScore[currentKey],
                    g: gScore[currentKey],
                    h: fScore[currentKey] - gScore[currentKey]
                };
                steps.push({
                    type: 'current',
                    node: {x: current.x, y: current.y, ...currentValues},
                    openSet: openSet.map(n => {
                        const nKey = key(n.x, n.y);
                        return {
                            x: n.x,
                            y: n.y,
                            f: fScore[nKey],
                            g: gScore[nKey],
                            h: fScore[nKey] - gScore[nKey]
                        };
                    }),
                    closedSet: Array.from(closedSet).map(k => {
                        const [x, y] = k.split(',').map(Number);
                        return {
                            x, y,
                            f: fScore[k],
                            g: gScore[k],
                            h: fScore[k] - gScore[k]
                        };
                    })
                });
                
                closedSet.add(currentKey);
                
                // æ¢ç´¢é‚»å±…ï¼ˆä¸Šä¸‹å·¦å³ï¼‰
                const neighbors = [
                    {x: current.x, y: current.y - 1},
                    {x: current.x, y: current.y + 1},
                    {x: current.x - 1, y: current.y},
                    {x: current.x + 1, y: current.y}
                ];
                
                for (const neighbor of neighbors) {
                    const nKey = key(neighbor.x, neighbor.y);
                    
                    // è¾¹ç•Œæ£€æŸ¥
                    if (neighbor.x < 0 || neighbor.x >= COLS || neighbor.y < 0 || neighbor.y >= ROWS) {
                        continue;
                    }
                    
                    // éšœç¢ç‰©æ£€æŸ¥
                    if (grid[neighbor.y][neighbor.x] === WALL) {
                        continue;
                    }
                    
                    // å·²åœ¨å…³é—­åˆ—è¡¨ä¸­
                    if (closedSet.has(nKey)) {
                        continue;
                    }
                    
                    const tentativeG = gScore[currentKey] + 1;
                    
                    if (!gScore[nKey] || tentativeG < gScore[nKey]) {
                        cameFrom[nKey] = currentKey;
                        gScore[nKey] = tentativeG;
                        fScore[nKey] = tentativeG + heuristic(neighbor, endNode);
                        
                        // å¦‚æœä¸åœ¨å¼€æ”¾åˆ—è¡¨ä¸­ï¼Œæ·»åŠ 
                        if (!openSet.find(n => n.x === neighbor.x && n.y === neighbor.y)) {
                            openSet.push({
                                x: neighbor.x,
                                y: neighbor.y,
                                g: tentativeG,
                                h: heuristic(neighbor, endNode),
                                f: fScore[nKey]
                            });
                        }
                    }
                }
            }
            
            return steps;
        }

        // é–‹å§‹è¦–è¦ºåŒ–å‹•ç•«
        function startVisualization() {
            if (isRunning) return;
            isRunning = true;
            visualizationStep = 0;
            nodeValues = {};
            visualizationData = aStar();
            
            // é‡ç½®ç½‘æ ¼æ˜¾ç¤ºçŠ¶æ€
            for (let i = 0; i < ROWS; i++) {
                for (let j = 0; j < COLS; j++) {
                    if (grid[i][j] !== START && grid[i][j] !== END && grid[i][j] !== WALL) {
                        grid[i][j] = EMPTY;
                    }
                }
            }
            
            animateVisualization();
        }

        // å‹•ç•«è¦–è¦ºåŒ–æµç¨‹
        function animateVisualization() {
            if (visualizationStep >= visualizationData.length) {
                isRunning = false;
                return;
            }
            
            const step = visualizationData[visualizationStep];
            
            if (step.type === 'current') {
                // æ¸…é™¤ä¹‹å‰çš„å½“å‰èŠ‚ç‚¹æ ‡è®°
                for (let i = 0; i < ROWS; i++) {
                    for (let j = 0; j < COLS; j++) {
                        if (grid[i][j] === CURRENT) {
                            grid[i][j] = CLOSED;
                        }
                    }
                }
                
                // æ›´æ–°èŠ‚ç‚¹å€¼
                if (step.node.f !== undefined) {
                    const nodeKey = `${step.node.x},${step.node.y}`;
                    nodeValues[nodeKey] = {
                        f: step.node.f,
                        g: step.node.g,
                        h: step.node.h
                    };
                }
                
                // æ ‡è®°å¼€æ”¾åˆ—è¡¨
                step.openSet.forEach(n => {
                    if (grid[n.y][n.x] === EMPTY) {
                        grid[n.y][n.x] = OPEN;
                    }
                    // æ›´æ–°å¼€æ”¾åˆ—è¡¨èŠ‚ç‚¹çš„å€¼
                    if (n.f !== undefined) {
                        const nodeKey = `${n.x},${n.y}`;
                        nodeValues[nodeKey] = {
                            f: n.f,
                            g: n.g,
                            h: n.h
                        };
                    }
                });
                
                // æ ‡è®°å…³é—­åˆ—è¡¨
                step.closedSet.forEach(n => {
                    if (grid[n.y][n.x] !== START && grid[n.y][n.x] !== END) {
                        grid[n.y][n.x] = CLOSED;
                    }
                    // æ›´æ–°å…³é—­åˆ—è¡¨èŠ‚ç‚¹çš„å€¼
                    if (n.f !== undefined) {
                        const nodeKey = `${n.x},${n.y}`;
                        nodeValues[nodeKey] = {
                            f: n.f,
                            g: n.g,
                            h: n.h
                        };
                    }
                });
                
                // æ ‡è®°å½“å‰èŠ‚ç‚¹
                if (grid[step.node.y][step.node.x] !== START && grid[step.node.y][step.node.x] !== END) {
                    grid[step.node.y][step.node.x] = CURRENT;
                }
                
                renderGrid();
                updateStats(step.openSet.length, step.closedSet.length + 1, null);
                document.getElementById('info').textContent = 
                    `æ­¥é©Ÿ ${visualizationStep + 1}/${visualizationData.length}: æ­£åœ¨æ¢ç´¢ç¯€é» (${step.node.x}, ${step.node.y}) f=${step.node.f || '?'} g=${step.node.g || '?'} h=${step.node.h || '?'}`;
                
                visualizationStep++;
                setTimeout(() => animateVisualization(), 300);
            } else if (step.type === 'path') {
                // é¡¯ç¤ºæœ€çµ‚è·¯å¾‘
                const closedCount = step.closedSet ? step.closedSet.length : 0;
                step.path.forEach((node, index) => {
                    if (grid[node.y][node.x] !== START && grid[node.y][node.x] !== END) {
                        setTimeout(() => {
                            grid[node.y][node.x] = PATH;
                            renderGrid();
                            if (index === step.path.length - 1) {
                                updateStats(0, closedCount, step.path.length - 1);
                                document.getElementById('info').textContent = 
                                    `âœ… æ‰¾åˆ°è·¯å¾‘ï¼è·¯å¾‘é•·åº¦ï¼š${step.path.length - 1} æ­¥`;
                                isRunning = false;
                            }
                        }, index * 100);
                    }
                });
            }
        }

        // å–®æ­¥åŸ·è¡Œ
        function stepByStep() {
            if (visualizationData.length === 0) {
                nodeValues = {};
                visualizationData = aStar();
                for (let i = 0; i < ROWS; i++) {
                    for (let j = 0; j < COLS; j++) {
                        if (grid[i][j] !== START && grid[i][j] !== END && grid[i][j] !== WALL) {
                            grid[i][j] = EMPTY;
                        }
                    }
                }
            }
            
            if (visualizationStep >= visualizationData.length) {
                return;
            }
            
            const step = visualizationData[visualizationStep];
            
            if (step.type === 'current') {
                // æ¸…é™¤å…ˆå‰çš„ç›®å‰ç¯€é»æ¨™è¨˜
                for (let i = 0; i < ROWS; i++) {
                    for (let j = 0; j < COLS; j++) {
                        if (grid[i][j] === CURRENT) {
                            grid[i][j] = CLOSED;
                        }
                    }
                }
                
                // æ›´æ–°èŠ‚ç‚¹å€¼
                if (step.node.f !== undefined) {
                    const nodeKey = `${step.node.x},${step.node.y}`;
                    nodeValues[nodeKey] = {
                        f: step.node.f,
                        g: step.node.g,
                        h: step.node.h
                    };
                }
                
                // æ¨™è¨˜é–‹æ”¾åˆ—è¡¨
                step.openSet.forEach(n => {
                    if (grid[n.y][n.x] === EMPTY) {
                        grid[n.y][n.x] = OPEN;
                    }
                    // æ›´æ–°å¼€æ”¾åˆ—è¡¨èŠ‚ç‚¹çš„å€¼
                    if (n.f !== undefined) {
                        const nodeKey = `${n.x},${n.y}`;
                        nodeValues[nodeKey] = {
                            f: n.f,
                            g: n.g,
                            h: n.h
                        };
                    }
                });
                
                // æ¨™è¨˜é—œé–‰åˆ—è¡¨
                step.closedSet.forEach(n => {
                    if (grid[n.y][n.x] !== START && grid[n.y][n.x] !== END) {
                        grid[n.y][n.x] = CLOSED;
                    }
                    // æ›´æ–°å…³é—­åˆ—è¡¨èŠ‚ç‚¹çš„å€¼
                    if (n.f !== undefined) {
                        const nodeKey = `${n.x},${n.y}`;
                        nodeValues[nodeKey] = {
                            f: n.f,
                            g: n.g,
                            h: n.h
                        };
                    }
                });
                
                // æ¨™è¨˜ç›®å‰ç¯€é»
                if (grid[step.node.y][step.node.x] !== START && grid[step.node.y][step.node.x] !== END) {
                    grid[step.node.y][step.node.x] = CURRENT;
                }
                
                renderGrid();
                updateStats(step.openSet.length, step.closedSet.length + 1, null);
                document.getElementById('info').textContent = 
                    `æ­¥é©Ÿ ${visualizationStep + 1}/${visualizationData.length}: æ­£åœ¨æ¢ç´¢ç¯€é» (${step.node.x}, ${step.node.y}) f=${step.node.f || '?'} g=${step.node.g || '?'} h=${step.node.h || '?'}`;
                
                visualizationStep++;
            } else if (step.type === 'path') {
                step.path.forEach((node, index) => {
                    if (grid[node.y][node.x] !== START && grid[node.y][node.x] !== END) {
                        grid[node.y][node.x] = PATH;
                    }
                });
                renderGrid();
                // å–å¾—é—œé–‰åˆ—è¡¨å¤§å°
                const closedCount = step.closedSet ? step.closedSet.length : 0;
                updateStats(0, closedCount, step.path.length - 1);
                document.getElementById('info').textContent = 
                    `âœ… æ‰¾åˆ°è·¯å¾‘ï¼è·¯å¾‘é•·åº¦ï¼š${step.path.length - 1} æ­¥`;
                visualizationStep = visualizationData.length;
            }
        }

        // æ›´æ–°çµ±è¨ˆè³‡è¨Š
        function updateStats(openCount, closedCount, pathLength) {
            document.getElementById('openCount').textContent = openCount;
            document.getElementById('closedCount').textContent = closedCount;
            document.getElementById('pathLength').textContent = pathLength !== null ? pathLength : '-';
        }

        // é‡ç½®ç¶²æ ¼
        function resetGrid() {
            isRunning = false;
            visualizationStep = 0;
            visualizationData = [];
            nodeValues = {};
            applyScenario(currentScenario || 'near');
            document.getElementById('info').textContent = '';
            updateStats(0, 0, null);
        }

        // åˆå§‹åŒ–ï¼šé è¨­ä½¿ç”¨æƒ…å¢ƒä¸€
        applyScenario('near');
    </script>

    <!-- æµ®å‹•æŒ‰éˆ• -->
    <div class="float-button">
        <button class="float-btn back-btn" id="back-btn" title="è¿”å›ä¸Šä¸€é ">
            <span class="float-btn-icon">â†</span>
            <span class="float-btn-text">è¿”å›</span>
        </button>
        <button class="float-btn top-btn" id="top-btn" title="å›åˆ°é ‚éƒ¨">
            <span class="float-btn-icon">â†‘</span>
            <span class="float-btn-text">é¡¶éƒ¨</span>
        </button>
    </div>

    <script>
        // æµ®å‹•æŒ‰éˆ•åŠŸèƒ½ - ç¢ºä¿åœ¨ DOM è¼‰å…¥å¾ŒåŸ·è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            const floatButtons = document.querySelectorAll('.float-btn');
            const topBtn = document.getElementById('top-btn');
            const backBtn = document.getElementById('back-btn');

            // é¡¯ç¤ºï¼éš±è—æµ®å‹•æŒ‰éˆ•
            function toggleFloatButtons() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                floatButtons.forEach(btn => {
                    if (scrollTop > 300) {
                        btn.classList.add('show');
                    } else {
                        btn.classList.remove('show');
                    }
                });
            }

            // å›åˆ°é ‚éƒ¨
            if (topBtn) {
                topBtn.addEventListener('click', () => {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }

            // è¿”å›ä¸Šä¸€é 
            if (backBtn) {
                backBtn.addEventListener('click', () => {
                    if (document.referrer && document.referrer !== window.location.href) {
                        window.history.back();
                    } else {
                        window.location.href = '../index.html';
                    }
                });
            }

            // ç›£è½å·å‹•äº‹ä»¶
            window.addEventListener('scroll', toggleFloatButtons);
            toggleFloatButtons(); // åˆå§‹æª¢æŸ¥
            
            // å¦‚æœé é¢å·²ç¶“å·å‹•ï¼Œç«‹å³é¡¯ç¤ºæŒ‰éˆ•
            if (window.pageYOffset > 300) {
                floatButtons.forEach(btn => btn.classList.add('show'));
            }
        });
    </script>
</body>
</html>